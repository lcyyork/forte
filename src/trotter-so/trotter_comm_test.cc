#include "psi4/libpsi4util/process.h"
#include "helpers/timer.h"

#include "trotter_so.h"

using namespace psi;

namespace forte {

void TROTTER_SO::H_Ta_C(double factor, BlockedTensor& H1, BlockedTensor& H2, BlockedTensor& T1,
                        BlockedTensor& T2, double& C0, BlockedTensor& C1, BlockedTensor& C2) {
    BlockedTensor temp;
    C0 = 0.0;
    C1.zero();
    C2.zero();

    C0 += 1.0 * H1["a0,c0"] * T1["c0,a0"];
    C0 += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v0,a0"];
    C0 += (1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,a0,a1"];
    C0 += 1.0 * H1["v0,a0"] * T1["a1,v0"] * L1_["a0,a1"];
    C0 += (1.0 / 2.0) * H1["v0,a0"] * T2["a2,a3,v0,a1"] * L2_["a0,a1,a2,a3"];
    C0 += -1.0 * H1["a0,c0"] * T1["c0,a1"] * L1_["a1,a0"];
    C0 += (-1.0 / 2.0) * H1["a0,c0"] * T2["c0,a1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C0 += (1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["c0,a1,v0,v1"] * L1_["a0,a1"];
    C0 += (1.0 / 8.0) * H2["v0,v1,a0,a1"] * T2["a2,a3,v0,v1"] * L2_["a0,a1,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v0,a1"] * L1_["a1,a0"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["c0,a2,v0,a1"] * L1_["a0,a2"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["c0,a3,v0,a2"] * L2_["a0,a2,a1,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a2,a0,a1"] * T1["a3,v0"] * L2_["a0,a1,a2,a3"];
    C0 += (1.0 / 4.0) * H2["v0,a2,a0,a1"] * T2["a3,a4,v0,a2"] * L2_["a0,a1,a3,a4"];
    C0 += (-1.0 / 4.0) * H2["v0,a2,a0,a1"] * T2["a4,a5,v0,a3"] * L3_["a0,a1,a3,a2,a4,a5"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    C0 += (1.0 / 8.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C0 += (1.0 / 2.0) * H2["a1,a2,c0,a0"] * T1["c0,a3"] * L2_["a0,a3,a1,a2"];
    C0 += (1.0 / 2.0) * H2["a1,a2,c0,a0"] * T2["c0,a3,a1,a2"] * L1_["a0,a3"];
    C0 += 1.0 * H2["a1,a2,c0,a0"] * T2["c0,a3,a1,a4"] * L2_["a0,a4,a2,a3"];
    C0 += (1.0 / 4.0) * H2["a1,a2,c0,a0"] * T2["c0,a3,a4,a5"] * L3_["a0,a4,a5,a1,a2,a3"];
    C0 += (1.0 / 4.0) * H2["v0,v1,a0,a1"] * T2["a2,a3,v0,v1"] * L1_["a0,a2"] * L1_["a1,a3"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["c0,a3,v0,a2"] * L1_["a0,a3"] * L1_["a2,a1"];
    C0 += (1.0 / 2.0) * H2["v0,a2,a0,a1"] * T2["a3,a4,v0,a2"] * L1_["a0,a3"] * L1_["a1,a4"];
    C0 += 1.0 * H2["v0,a2,a0,a1"] * T2["a4,a5,v0,a3"] * L1_["a0,a4"] * L2_["a1,a3,a2,a5"];
    C0 += (-1.0 / 4.0) * H2["v0,a2,a0,a1"] * T2["a4,a5,v0,a3"] * L1_["a3,a2"] * L2_["a0,a1,a4,a5"];
    C0 += (1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,a2,a3"] * L1_["a2,a0"] * L1_["a3,a1"];
    C0 += -1.0 * H2["a1,a2,c0,a0"] * T2["c0,a3,a1,a4"] * L1_["a0,a3"] * L1_["a4,a2"];
    C0 += (1.0 / 4.0) * H2["a1,a2,c0,a0"] * T2["c0,a3,a4,a5"] * L1_["a0,a3"] * L2_["a4,a5,a1,a2"];
    C0 += -1.0 * H2["a1,a2,c0,a0"] * T2["c0,a3,a4,a5"] * L1_["a4,a1"] * L2_["a0,a5,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a2,a0,a1"] * T2["a4,a5,v0,a3"] * L1_["a0,a4"] * L1_["a1,a5"] *
          L1_["a3,a2"];
    C0 += (1.0 / 2.0) * H2["a1,a2,c0,a0"] * T2["c0,a3,a4,a5"] * L1_["a0,a3"] * L1_["a4,a1"] *
          L1_["a5,a2"];

    C1["c0,v0"] += -1.0 * H1["c0,a0"] * T1["a0,v0"];
    C1["c0,v0"] += 1.0 * H1["a0,v0"] * T1["c0,a0"];
    C1["c0,v0"] += 1.0 * H1["a0,c1"] * T2["c0,c1,v0,a0"];
    C1["c0,v0"] += 1.0 * H2["v1,a0,v0,c1"] * T2["c0,c1,v1,a0"];
    C1["c0,v0"] += 1.0 * H2["c0,a0,v0,c1"] * T1["c1,a0"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c1,c2,v0,a0"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["a0,a1,v0,c1"] * T2["c0,c1,a0,a1"];
    C1["c0,v0"] += 1.0 * H1["v1,a0"] * T2["c0,a1,v0,v1"] * L1_["a0,a1"];
    C1["c0,v0"] += -1.0 * H1["a0,c1"] * T2["c0,c1,v0,a1"] * L1_["a1,a0"];
    C1["c0,v0"] += -1.0 * H1["a1,a0"] * T2["c0,a0,v0,a2"] * L1_["a2,a1"];
    C1["c0,v0"] += 1.0 * H1["a1,a0"] * T2["c0,a2,v0,a1"] * L1_["a0,a2"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["v1,v2,v0,a0"] * T2["c0,a1,v1,v2"] * L1_["a0,a1"];
    C1["c0,v0"] += -1.0 * H2["v1,c0,v0,a0"] * T1["a1,v1"] * L1_["a0,a1"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["v1,c0,v0,a0"] * T2["a2,a3,v1,a1"] * L2_["a0,a1,a2,a3"];
    C1["c0,v0"] += 1.0 * H2["v1,c0,c1,a0"] * T2["c1,a1,v0,v1"] * L1_["a0,a1"];
    C1["c0,v0"] += (1.0 / 4.0) * H2["v1,c0,a0,a1"] * T2["a2,a3,v0,v1"] * L2_["a0,a1,a2,a3"];
    C1["c0,v0"] += -1.0 * H2["v1,a0,v0,c1"] * T2["c0,c1,v1,a1"] * L1_["a1,a0"];
    C1["c0,v0"] += 1.0 * H2["v1,a1,v0,a0"] * T2["c0,a2,v1,a1"] * L1_["a0,a2"];
    C1["c0,v0"] += 1.0 * H2["v1,a1,v0,a0"] * T2["c0,a3,v1,a2"] * L2_["a0,a2,a1,a3"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["v1,a2,a0,a1"] * T2["c0,a3,v0,v1"] * L2_["a0,a1,a2,a3"];
    C1["c0,v0"] += -1.0 * H2["c0,a0,v0,c1"] * T1["c1,a1"] * L1_["a1,a0"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["c0,a0,v0,c1"] * T2["c1,a1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c1,c2,v0,a1"] * L1_["a1,a0"];
    C1["c0,v0"] += -1.0 * H2["c0,a1,c1,a0"] * T2["c1,a2,v0,a1"] * L1_["a0,a2"];
    C1["c0,v0"] += -1.0 * H2["c0,a1,c1,a0"] * T2["c1,a3,v0,a2"] * L2_["a0,a2,a1,a3"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["c0,a2,a0,a1"] * T2["a0,a1,v0,a3"] * L1_["a3,a2"];
    C1["c0,v0"] += -1.0 * H2["c0,a2,a0,a1"] * T2["a0,a4,v0,a3"] * L2_["a1,a3,a2,a4"];
    C1["c0,v0"] += (-1.0 / 4.0) * H2["c0,a2,a0,a1"] * T2["a3,a4,v0,a2"] * L2_["a0,a1,a3,a4"];
    C1["c0,v0"] += -1.0 * H2["a0,a1,v0,c1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    C1["c0,v0"] += (1.0 / 4.0) * H2["a0,a1,v0,c1"] * T2["c0,c1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["a1,a2,v0,a0"] * T2["c0,a3,a1,a2"] * L1_["a0,a3"];
    C1["c0,v0"] += 1.0 * H2["a1,a2,v0,a0"] * T2["c0,a3,a1,a4"] * L2_["a0,a4,a2,a3"];
    C1["c0,v0"] += (1.0 / 4.0) * H2["a1,a2,v0,a0"] * T2["c0,a0,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["a1,a2,c1,a0"] * T2["c0,c1,v0,a3"] * L2_["a0,a3,a1,a2"];
    C1["c0,v0"] += (1.0 / 2.0) * H2["a2,a3,a0,a1"] * T2["c0,a0,v0,a4"] * L2_["a1,a4,a2,a3"];
    C1["c0,v0"] += (-1.0 / 2.0) * H2["a2,a3,a0,a1"] * T2["c0,a4,v0,a2"] * L2_["a0,a1,a3,a4"];
    C1["c0,v0"] +=
        (1.0 / 2.0) * H2["v1,c0,a0,a1"] * T2["a2,a3,v0,v1"] * L1_["a0,a2"] * L1_["a1,a3"];
    C1["c0,v0"] += -1.0 * H2["v1,a1,v0,a0"] * T2["c0,a3,v1,a2"] * L1_["a0,a3"] * L1_["a2,a1"];
    C1["c0,v0"] += 1.0 * H2["c0,a1,c1,a0"] * T2["c1,a3,v0,a2"] * L1_["a0,a3"] * L1_["a2,a1"];
    C1["c0,v0"] += 1.0 * H2["c0,a2,a0,a1"] * T2["a0,a4,v0,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["c0,v0"] +=
        (-1.0 / 2.0) * H2["c0,a2,a0,a1"] * T2["a3,a4,v0,a2"] * L1_["a0,a3"] * L1_["a1,a4"];
    C1["c0,v0"] +=
        (1.0 / 2.0) * H2["a0,a1,v0,c1"] * T2["c0,c1,a2,a3"] * L1_["a2,a0"] * L1_["a3,a1"];
    C1["c0,v0"] += -1.0 * H2["a1,a2,v0,a0"] * T2["c0,a3,a1,a4"] * L1_["a0,a3"] * L1_["a4,a2"];
    C1["c0,v0"] +=
        (1.0 / 2.0) * H2["a1,a2,v0,a0"] * T2["c0,a0,a3,a4"] * L1_["a3,a1"] * L1_["a4,a2"];

    C1["a0,v0"] += 1.0 * H1["v1,v0"] * T1["a0,v1"];
    C1["a0,v0"] += -1.0 * H1["v1,c0"] * T2["c0,a0,v0,v1"];
    C1["a0,v0"] += -1.0 * H1["a0,a1"] * T1["a1,v0"];
    C1["a0,v0"] += -1.0 * H1["a1,c0"] * T2["c0,a0,v0,a1"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["v1,v2,v0,c0"] * T2["c0,a0,v1,v2"];
    C1["a0,v0"] += -1.0 * H2["v1,a1,v0,c0"] * T2["c0,a0,v1,a1"];
    C1["a0,v0"] += 1.0 * H2["a0,a1,v0,c0"] * T1["c0,a1"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,v0,a1"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a1,a2,v0,c0"] * T2["c0,a0,a1,a2"];
    C1["a0,v0"] += 1.0 * H1["v1,a1"] * T2["a0,a2,v0,v1"] * L1_["a1,a2"];
    C1["a0,v0"] += 1.0 * H1["a1,c0"] * T2["c0,a0,v0,a2"] * L1_["a2,a1"];
    C1["a0,v0"] += -1.0 * H1["a2,a1"] * T2["a0,a1,v0,a3"] * L1_["a3,a2"];
    C1["a0,v0"] += 1.0 * H1["a2,a1"] * T2["a0,a3,v0,a2"] * L1_["a1,a3"];
    C1["a0,v0"] += (1.0 / 2.0) * H2["v1,v2,v0,a1"] * T2["a0,a2,v1,v2"] * L1_["a1,a2"];
    C1["a0,v0"] += -1.0 * H2["v1,a0,v0,a1"] * T1["a2,v1"] * L1_["a1,a2"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["v1,a0,v0,a1"] * T2["a3,a4,v1,a2"] * L2_["a1,a2,a3,a4"];
    C1["a0,v0"] += 1.0 * H2["v1,a0,c0,a1"] * T2["c0,a2,v0,v1"] * L1_["a1,a2"];
    C1["a0,v0"] += (1.0 / 4.0) * H2["v1,a0,a1,a2"] * T2["a3,a4,v0,v1"] * L2_["a1,a2,a3,a4"];
    C1["a0,v0"] += 1.0 * H2["v1,a1,v0,c0"] * T2["c0,a0,v1,a2"] * L1_["a2,a1"];
    C1["a0,v0"] += 1.0 * H2["v1,a2,v0,a1"] * T2["a0,a3,v1,a2"] * L1_["a1,a3"];
    C1["a0,v0"] += 1.0 * H2["v1,a2,v0,a1"] * T2["a0,a4,v1,a3"] * L2_["a1,a3,a2,a4"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["v1,a3,a1,a2"] * T2["a0,a4,v0,v1"] * L2_["a1,a2,a3,a4"];
    C1["a0,v0"] += -1.0 * H2["a0,a1,v0,c0"] * T1["c0,a2"] * L1_["a2,a1"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a0,a1,v0,c0"] * T2["c0,a2,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["a0,v0"] += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,v0,a2"] * L1_["a2,a1"];
    C1["a0,v0"] += -1.0 * H2["a0,a2,c0,a1"] * T2["c0,a3,v0,a2"] * L1_["a1,a3"];
    C1["a0,v0"] += -1.0 * H2["a0,a2,c0,a1"] * T2["c0,a4,v0,a3"] * L2_["a1,a3,a2,a4"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a0,a3,a1,a2"] * T2["a1,a2,v0,a4"] * L1_["a4,a3"];
    C1["a0,v0"] += -1.0 * H2["a0,a3,a1,a2"] * T2["a1,a5,v0,a4"] * L2_["a2,a4,a3,a5"];
    C1["a0,v0"] += (-1.0 / 4.0) * H2["a0,a3,a1,a2"] * T2["a4,a5,v0,a3"] * L2_["a1,a2,a4,a5"];
    C1["a0,v0"] += 1.0 * H2["a1,a2,v0,c0"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    C1["a0,v0"] += (-1.0 / 4.0) * H2["a1,a2,v0,c0"] * T2["c0,a0,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a2,a3,c0,a1"] * T2["c0,a0,v0,a4"] * L2_["a1,a4,a2,a3"];
    C1["a0,v0"] += (1.0 / 2.0) * H2["a3,a4,a1,a2"] * T2["a0,a1,v0,a5"] * L2_["a2,a5,a3,a4"];
    C1["a0,v0"] += (-1.0 / 2.0) * H2["a3,a4,a1,a2"] * T2["a0,a5,v0,a3"] * L2_["a1,a2,a4,a5"];
    C1["a0,v0"] +=
        (1.0 / 2.0) * H2["v1,a0,a1,a2"] * T2["a3,a4,v0,v1"] * L1_["a1,a3"] * L1_["a2,a4"];
    C1["a0,v0"] += -1.0 * H2["v1,a2,v0,a1"] * T2["a0,a4,v1,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["a0,v0"] += 1.0 * H2["a0,a2,c0,a1"] * T2["c0,a4,v0,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["a0,v0"] += 1.0 * H2["a0,a3,a1,a2"] * T2["a1,a5,v0,a4"] * L1_["a2,a5"] * L1_["a4,a3"];
    C1["a0,v0"] +=
        (-1.0 / 2.0) * H2["a0,a3,a1,a2"] * T2["a4,a5,v0,a3"] * L1_["a1,a4"] * L1_["a2,a5"];
    C1["a0,v0"] +=
        (-1.0 / 2.0) * H2["a1,a2,v0,c0"] * T2["c0,a0,a3,a4"] * L1_["a3,a1"] * L1_["a4,a2"];

    C1["v0,v1"] += -1.0 * H1["v0,a0"] * T1["a0,v1"];
    C1["v0,v1"] += 1.0 * H2["v0,a0,v1,c0"] * T1["c0,a0"];
    C1["v0,v1"] += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v1,a0"];
    C1["v0,v1"] += 1.0 * H2["v0,v2,v1,a0"] * T1["a1,v2"] * L1_["a0,a1"];
    C1["v0,v1"] += (1.0 / 2.0) * H2["v0,v2,v1,a0"] * T2["a2,a3,v2,a1"] * L2_["a0,a1,a2,a3"];
    C1["v0,v1"] += -1.0 * H2["v0,v2,c0,a0"] * T2["c0,a1,v1,v2"] * L1_["a0,a1"];
    C1["v0,v1"] += (-1.0 / 4.0) * H2["v0,v2,a0,a1"] * T2["a2,a3,v1,v2"] * L2_["a0,a1,a2,a3"];
    C1["v0,v1"] += -1.0 * H2["v0,a0,v1,c0"] * T1["c0,a1"] * L1_["a1,a0"];
    C1["v0,v1"] += (-1.0 / 2.0) * H2["v0,a0,v1,c0"] * T2["c0,a1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C1["v0,v1"] += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v1,a1"] * L1_["a1,a0"];
    C1["v0,v1"] += -1.0 * H2["v0,a1,c0,a0"] * T2["c0,a2,v1,a1"] * L1_["a0,a2"];
    C1["v0,v1"] += -1.0 * H2["v0,a1,c0,a0"] * T2["c0,a3,v1,a2"] * L2_["a0,a2,a1,a3"];
    C1["v0,v1"] += (-1.0 / 2.0) * H2["v0,a2,a0,a1"] * T2["a0,a1,v1,a3"] * L1_["a3,a2"];
    C1["v0,v1"] += -1.0 * H2["v0,a2,a0,a1"] * T2["a0,a4,v1,a3"] * L2_["a1,a3,a2,a4"];
    C1["v0,v1"] += (-1.0 / 4.0) * H2["v0,a2,a0,a1"] * T2["a3,a4,v1,a2"] * L2_["a0,a1,a3,a4"];
    C1["v0,v1"] +=
        (-1.0 / 2.0) * H2["v0,v2,a0,a1"] * T2["a2,a3,v1,v2"] * L1_["a0,a2"] * L1_["a1,a3"];
    C1["v0,v1"] += 1.0 * H2["v0,a1,c0,a0"] * T2["c0,a3,v1,a2"] * L1_["a0,a3"] * L1_["a2,a1"];
    C1["v0,v1"] += 1.0 * H2["v0,a2,a0,a1"] * T2["a0,a4,v1,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["v0,v1"] +=
        (-1.0 / 2.0) * H2["v0,a2,a0,a1"] * T2["a3,a4,v1,a2"] * L1_["a0,a3"] * L1_["a1,a4"];

    C1["v0,c0"] += 1.0 * H2["v0,a0,c0,c1"] * T1["c1,a0"];
    C1["v0,c0"] += 1.0 * H2["v0,v1,c0,a0"] * T1["a1,v1"] * L1_["a0,a1"];
    C1["v0,c0"] += (1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["a2,a3,v1,a1"] * L2_["a0,a1,a2,a3"];
    C1["v0,c0"] += -1.0 * H2["v0,a0,c0,c1"] * T1["c1,a1"] * L1_["a1,a0"];
    C1["v0,c0"] += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c1,a1,a2,a3"] * L2_["a2,a3,a0,a1"];

    C1["a0,c0"] += 1.0 * H1["v0,c0"] * T1["a0,v0"];
    C1["a0,c0"] += (-1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["c1,a0,v0,v1"];
    C1["a0,c0"] += -1.0 * H2["v0,a1,c0,c1"] * T2["c1,a0,v0,a1"];
    C1["a0,c0"] += 1.0 * H2["a0,a1,c0,c1"] * T1["c1,a1"];
    C1["a0,c0"] += (-1.0 / 2.0) * H2["a1,a2,c0,c1"] * T2["c1,a0,a1,a2"];
    C1["a0,c0"] += (1.0 / 2.0) * H2["v0,v1,c0,a1"] * T2["a0,a2,v0,v1"] * L1_["a1,a2"];
    C1["a0,c0"] += -1.0 * H2["v0,a0,c0,a1"] * T1["a2,v0"] * L1_["a1,a2"];
    C1["a0,c0"] += (-1.0 / 2.0) * H2["v0,a0,c0,a1"] * T2["a3,a4,v0,a2"] * L2_["a1,a2,a3,a4"];
    C1["a0,c0"] += 1.0 * H2["v0,a1,c0,c1"] * T2["c1,a0,v0,a2"] * L1_["a2,a1"];
    C1["a0,c0"] += 1.0 * H2["v0,a2,c0,a1"] * T2["a0,a3,v0,a2"] * L1_["a1,a3"];
    C1["a0,c0"] += 1.0 * H2["v0,a2,c0,a1"] * T2["a0,a4,v0,a3"] * L2_["a1,a3,a2,a4"];
    C1["a0,c0"] += -1.0 * H2["a0,a1,c0,c1"] * T1["c1,a2"] * L1_["a2,a1"];
    C1["a0,c0"] += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c1,a2,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["a0,c0"] += 1.0 * H2["a1,a2,c0,c1"] * T2["c1,a0,a1,a3"] * L1_["a3,a2"];
    C1["a0,c0"] += (-1.0 / 4.0) * H2["a1,a2,c0,c1"] * T2["c1,a0,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["a0,c0"] += -1.0 * H2["v0,a2,c0,a1"] * T2["a0,a4,v0,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["a0,c0"] +=
        (-1.0 / 2.0) * H2["a1,a2,c0,c1"] * T2["c1,a0,a3,a4"] * L1_["a3,a1"] * L1_["a4,a2"];

    C1["c0,c1"] += 1.0 * H1["a0,c1"] * T1["c0,a0"];
    C1["c0,c1"] += 1.0 * H2["v0,a0,c1,c2"] * T2["c0,c2,v0,a0"];
    C1["c0,c1"] += 1.0 * H2["c0,a0,c1,c2"] * T1["c2,a0"];
    C1["c0,c1"] += (1.0 / 2.0) * H2["a0,a1,c1,c2"] * T2["c0,c2,a0,a1"];
    C1["c0,c1"] += (1.0 / 2.0) * H2["v0,v1,c1,a0"] * T2["c0,a1,v0,v1"] * L1_["a0,a1"];
    C1["c0,c1"] += -1.0 * H2["v0,c0,c1,a0"] * T1["a1,v0"] * L1_["a0,a1"];
    C1["c0,c1"] += (-1.0 / 2.0) * H2["v0,c0,c1,a0"] * T2["a2,a3,v0,a1"] * L2_["a0,a1,a2,a3"];
    C1["c0,c1"] += -1.0 * H2["v0,a0,c1,c2"] * T2["c0,c2,v0,a1"] * L1_["a1,a0"];
    C1["c0,c1"] += 1.0 * H2["v0,a1,c1,a0"] * T2["c0,a2,v0,a1"] * L1_["a0,a2"];
    C1["c0,c1"] += 1.0 * H2["v0,a1,c1,a0"] * T2["c0,a3,v0,a2"] * L2_["a0,a2,a1,a3"];
    C1["c0,c1"] += -1.0 * H2["c0,a0,c1,c2"] * T1["c2,a1"] * L1_["a1,a0"];
    C1["c0,c1"] += (-1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c2,a1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C1["c0,c1"] += -1.0 * H2["a0,a1,c1,c2"] * T2["c0,c2,a0,a2"] * L1_["a2,a1"];
    C1["c0,c1"] += (1.0 / 4.0) * H2["a0,a1,c1,c2"] * T2["c0,c2,a2,a3"] * L2_["a2,a3,a0,a1"];
    C1["c0,c1"] += (1.0 / 2.0) * H2["a1,a2,c1,a0"] * T2["c0,a3,a1,a2"] * L1_["a0,a3"];
    C1["c0,c1"] += 1.0 * H2["a1,a2,c1,a0"] * T2["c0,a3,a1,a4"] * L2_["a0,a4,a2,a3"];
    C1["c0,c1"] += (1.0 / 4.0) * H2["a1,a2,c1,a0"] * T2["c0,a0,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["c0,c1"] += -1.0 * H2["v0,a1,c1,a0"] * T2["c0,a3,v0,a2"] * L1_["a0,a3"] * L1_["a2,a1"];
    C1["c0,c1"] +=
        (1.0 / 2.0) * H2["a0,a1,c1,c2"] * T2["c0,c2,a2,a3"] * L1_["a2,a0"] * L1_["a3,a1"];
    C1["c0,c1"] += -1.0 * H2["a1,a2,c1,a0"] * T2["c0,a3,a1,a4"] * L1_["a0,a3"] * L1_["a4,a2"];
    C1["c0,c1"] +=
        (1.0 / 2.0) * H2["a1,a2,c1,a0"] * T2["c0,a0,a3,a4"] * L1_["a3,a1"] * L1_["a4,a2"];

    C1["v0,a0"] += -1.0 * H1["v0,c0"] * T1["c0,a0"];
    C1["v0,a0"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,v1,a0"];
    C1["v0,a0"] += (-1.0 / 2.0) * H2["v0,a1,c0,c1"] * T2["c0,c1,a0,a1"];
    C1["v0,a0"] += -1.0 * H2["v0,a1,c0,a0"] * T1["c0,a1"];
    C1["v0,a0"] += 1.0 * H2["v0,v1,c0,a1"] * T2["c0,a2,v1,a0"] * L1_["a1,a2"];
    C1["v0,a0"] += 1.0 * H2["v0,v1,a0,a1"] * T1["a2,v1"] * L1_["a1,a2"];
    C1["v0,a0"] += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v1,a2"] * L2_["a1,a2,a3,a4"];
    C1["v0,a0"] += (1.0 / 4.0) * H2["v0,v1,a1,a2"] * T2["a3,a4,v1,a0"] * L2_["a1,a2,a3,a4"];
    C1["v0,a0"] += (1.0 / 2.0) * H2["v0,a1,c0,c1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    C1["v0,a0"] += 1.0 * H2["v0,a1,c0,a0"] * T1["c0,a2"] * L1_["a2,a1"];
    C1["v0,a0"] += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["c0,a2,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["v0,a0"] += -1.0 * H2["v0,a2,c0,a1"] * T2["c0,a3,a0,a2"] * L1_["a1,a3"];
    C1["v0,a0"] += -1.0 * H2["v0,a2,c0,a1"] * T2["c0,a3,a0,a4"] * L2_["a1,a4,a2,a3"];
    C1["v0,a0"] +=
        (1.0 / 2.0) * H2["v0,v1,a1,a2"] * T2["a3,a4,v1,a0"] * L1_["a1,a3"] * L1_["a2,a4"];
    C1["v0,a0"] += 1.0 * H2["v0,a2,c0,a1"] * T2["c0,a3,a0,a4"] * L1_["a1,a3"] * L1_["a4,a2"];

    C1["c0,a0"] += -1.0 * H1["v0,c1"] * T2["c0,c1,v0,a0"];
    C1["c0,a0"] += -1.0 * H1["c0,c1"] * T1["c1,a0"];
    C1["c0,a0"] += 1.0 * H1["a1,c1"] * T2["c0,c1,a0,a1"];
    C1["c0,a0"] += 1.0 * H1["a1,a0"] * T1["c0,a1"];
    C1["c0,a0"] += (-1.0 / 2.0) * H2["v0,c0,c1,c2"] * T2["c1,c2,v0,a0"];
    C1["c0,a0"] += -1.0 * H2["v0,a1,c1,a0"] * T2["c0,c1,v0,a1"];
    C1["c0,a0"] += (-1.0 / 2.0) * H2["c0,a1,c1,c2"] * T2["c1,c2,a0,a1"];
    C1["c0,a0"] += -1.0 * H2["c0,a1,c1,a0"] * T1["c1,a1"];
    C1["c0,a0"] += (-1.0 / 2.0) * H2["a1,a2,c1,a0"] * T2["c0,c1,a1,a2"];
    C1["c0,a0"] += -1.0 * H1["v0,a1"] * T2["c0,a2,v0,a0"] * L1_["a1,a2"];
    C1["c0,a0"] += -1.0 * H1["a1,c1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    C1["c0,a0"] += 1.0 * H1["a2,a1"] * T2["c0,a3,a0,a2"] * L1_["a1,a3"];
    C1["c0,a0"] += -1.0 * H1["a2,a1"] * T2["c0,a1,a0,a3"] * L1_["a3,a2"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["c0,a2,v0,v1"] * L1_["a1,a2"];
    C1["c0,a0"] += -1.0 * H2["v0,c0,c1,a1"] * T2["c1,a2,v0,a0"] * L1_["a1,a2"];
    C1["c0,a0"] += -1.0 * H2["v0,c0,a0,a1"] * T1["a2,v0"] * L1_["a1,a2"];
    C1["c0,a0"] += (-1.0 / 2.0) * H2["v0,c0,a0,a1"] * T2["a3,a4,v0,a2"] * L2_["a1,a2,a3,a4"];
    C1["c0,a0"] += (-1.0 / 4.0) * H2["v0,c0,a1,a2"] * T2["a3,a4,v0,a0"] * L2_["a1,a2,a3,a4"];
    C1["c0,a0"] += 1.0 * H2["v0,a1,c1,a0"] * T2["c0,c1,v0,a2"] * L1_["a2,a1"];
    C1["c0,a0"] += 1.0 * H2["v0,a2,a0,a1"] * T2["c0,a3,v0,a2"] * L1_["a1,a3"];
    C1["c0,a0"] += 1.0 * H2["v0,a2,a0,a1"] * T2["c0,a4,v0,a3"] * L2_["a1,a3,a2,a4"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["v0,a3,a1,a2"] * T2["c0,a4,v0,a0"] * L2_["a1,a2,a3,a4"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["c0,a1,c1,c2"] * T2["c1,c2,a0,a2"] * L1_["a2,a1"];
    C1["c0,a0"] += 1.0 * H2["c0,a1,c1,a0"] * T1["c1,a2"] * L1_["a2,a1"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["c0,a1,c1,a0"] * T2["c1,a2,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["c0,a0"] += -1.0 * H2["c0,a2,c1,a1"] * T2["c1,a3,a0,a2"] * L1_["a1,a3"];
    C1["c0,a0"] += -1.0 * H2["c0,a2,c1,a1"] * T2["c1,a3,a0,a4"] * L2_["a1,a4,a2,a3"];
    C1["c0,a0"] += 1.0 * H2["a1,a2,c1,a0"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    C1["c0,a0"] += (-1.0 / 4.0) * H2["a1,a2,c1,a0"] * T2["c0,c1,a3,a4"] * L2_["a3,a4,a1,a2"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["a2,a3,c1,a1"] * T2["c0,c1,a0,a4"] * L2_["a1,a4,a2,a3"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["a2,a3,a0,a1"] * T2["c0,a4,a2,a3"] * L1_["a1,a4"];
    C1["c0,a0"] += 1.0 * H2["a2,a3,a0,a1"] * T2["c0,a4,a2,a5"] * L2_["a1,a5,a3,a4"];
    C1["c0,a0"] += (1.0 / 4.0) * H2["a2,a3,a0,a1"] * T2["c0,a1,a4,a5"] * L2_["a4,a5,a2,a3"];
    C1["c0,a0"] += (-1.0 / 2.0) * H2["a3,a4,a1,a2"] * T2["c0,a5,a0,a3"] * L2_["a1,a2,a4,a5"];
    C1["c0,a0"] += (1.0 / 2.0) * H2["a3,a4,a1,a2"] * T2["c0,a1,a0,a5"] * L2_["a2,a5,a3,a4"];
    C1["c0,a0"] +=
        (-1.0 / 2.0) * H2["v0,c0,a1,a2"] * T2["a3,a4,v0,a0"] * L1_["a1,a3"] * L1_["a2,a4"];
    C1["c0,a0"] += -1.0 * H2["v0,a2,a0,a1"] * T2["c0,a4,v0,a3"] * L1_["a1,a4"] * L1_["a3,a2"];
    C1["c0,a0"] += 1.0 * H2["c0,a2,c1,a1"] * T2["c1,a3,a0,a4"] * L1_["a1,a3"] * L1_["a4,a2"];
    C1["c0,a0"] +=
        (-1.0 / 2.0) * H2["a1,a2,c1,a0"] * T2["c0,c1,a3,a4"] * L1_["a3,a1"] * L1_["a4,a2"];
    C1["c0,a0"] += -1.0 * H2["a2,a3,a0,a1"] * T2["c0,a4,a2,a5"] * L1_["a1,a4"] * L1_["a5,a3"];
    C1["c0,a0"] +=
        (1.0 / 2.0) * H2["a2,a3,a0,a1"] * T2["c0,a1,a4,a5"] * L1_["a4,a2"] * L1_["a5,a3"];

    C1["a0,a1"] += 1.0 * H1["v0,c0"] * T2["c0,a0,v0,a1"];
    C1["a0,a1"] += 1.0 * H1["v0,a1"] * T1["a0,v0"];
    C1["a0,a1"] += -1.0 * H1["a0,c0"] * T1["c0,a1"];
    C1["a0,a1"] += -1.0 * H1["a2,c0"] * T2["c0,a0,a1,a2"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["v0,v1,c0,a1"] * T2["c0,a0,v0,v1"];
    C1["a0,a1"] += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v0,a1"];
    C1["a0,a1"] += 1.0 * H2["v0,a2,c0,a1"] * T2["c0,a0,v0,a2"];
    C1["a0,a1"] += (-1.0 / 2.0) * H2["a0,a2,c0,c1"] * T2["c0,c1,a1,a2"];
    C1["a0,a1"] += -1.0 * H2["a0,a2,c0,a1"] * T1["c0,a2"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["a2,a3,c0,a1"] * T2["c0,a0,a2,a3"];
    C1["a0,a1"] += -1.0 * H1["v0,a2"] * T2["a0,a3,v0,a1"] * L1_["a2,a3"];
    C1["a0,a1"] += 1.0 * H1["a2,c0"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["v0,v1,a1,a2"] * T2["a0,a3,v0,v1"] * L1_["a2,a3"];
    C1["a0,a1"] += -1.0 * H2["v0,a0,c0,a2"] * T2["c0,a3,v0,a1"] * L1_["a2,a3"];
    C1["a0,a1"] += -1.0 * H2["v0,a0,a1,a2"] * T1["a3,v0"] * L1_["a2,a3"];
    C1["a0,a1"] += (-1.0 / 2.0) * H2["v0,a0,a1,a2"] * T2["a4,a5,v0,a3"] * L2_["a2,a3,a4,a5"];
    C1["a0,a1"] += (-1.0 / 4.0) * H2["v0,a0,a2,a3"] * T2["a4,a5,v0,a1"] * L2_["a2,a3,a4,a5"];
    C1["a0,a1"] += -1.0 * H2["v0,a2,c0,a1"] * T2["c0,a0,v0,a3"] * L1_["a3,a2"];
    C1["a0,a1"] += 1.0 * H2["v0,a3,a1,a2"] * T2["a0,a4,v0,a3"] * L1_["a2,a4"];
    C1["a0,a1"] += 1.0 * H2["v0,a3,a1,a2"] * T2["a0,a5,v0,a4"] * L2_["a2,a4,a3,a5"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["v0,a4,a2,a3"] * T2["a0,a5,v0,a1"] * L2_["a2,a3,a4,a5"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["a0,a2,c0,c1"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    C1["a0,a1"] += 1.0 * H2["a0,a2,c0,a1"] * T1["c0,a3"] * L1_["a3,a2"];
    C1["a0,a1"] += (1.0 / 2.0) * H2["a0,a2,c0,a1"] * T2["c0,a3,a4,a5"] * L2_["a4,a5,a2,a3"];
    C1["a0,a1"] += -1.0 * H2["a0,a3,c0,a2"] * T2["c0,a4,a1,a3"] * L1_["a2,a4"];
    C1["a0,a1"] += -1.0 * H2["a0,a3,c0,a2"] * T2["c0,a4,a1,a5"] * L2_["a2,a5,a3,a4"];
    C1["a0,a1"] += -1.0 * H2["a2,a3,c0,a1"] * T2["c0,a0,a2,a4"] * L1_["a4,a3"];
    C1["a0,a1"] += (1.0 / 4.0) * H2["a2,a3,c0,a1"] * T2["c0,a0,a4,a5"] * L2_["a4,a5,a2,a3"];
    C1["a0,a1"] += (-1.0 / 2.0) * H2["a3,a4,c0,a2"] * T2["c0,a0,a1,a5"] * L2_["a2,a5,a3,a4"];
    C1["a0,a1"] +=
        (-1.0 / 2.0) * H2["v0,a0,a2,a3"] * T2["a4,a5,v0,a1"] * L1_["a2,a4"] * L1_["a3,a5"];
    C1["a0,a1"] += -1.0 * H2["v0,a3,a1,a2"] * T2["a0,a5,v0,a4"] * L1_["a2,a5"] * L1_["a4,a3"];
    C1["a0,a1"] += 1.0 * H2["a0,a3,c0,a2"] * T2["c0,a4,a1,a5"] * L1_["a2,a4"] * L1_["a5,a3"];
    C1["a0,a1"] +=
        (1.0 / 2.0) * H2["a2,a3,c0,a1"] * T2["c0,a0,a4,a5"] * L1_["a4,a2"] * L1_["a5,a3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
    temp["c0,c1,v0,v1"] += 1.0 * H2["c0,a0,v0,c2"] * T2["c1,c2,v1,a0"];
    temp["c0,c1,v0,v1"] += -1.0 * H2["v2,c0,v0,a0"] * T2["c1,a1,v1,v2"] * L1_["a0,a1"];
    temp["c0,c1,v0,v1"] += -1.0 * H2["c0,a0,v0,c2"] * T2["c1,c2,v1,a1"] * L1_["a1,a0"];
    temp["c0,c1,v0,v1"] += -1.0 * H2["c0,a1,v0,a0"] * T2["c1,a0,v1,a2"] * L1_["a2,a1"];
    temp["c0,c1,v0,v1"] += 1.0 * H2["c0,a1,v0,a0"] * T2["c1,a2,v1,a1"] * L1_["a0,a2"];
    C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
    C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];
    C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];
    C2["c1,c0,v1,v0"] += temp["c0,c1,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
    temp["c0,c1,v0,v1"] += 1.0 * H1["c0,a0"] * T2["c1,a0,v0,v1"];
    temp["c0,c1,v0,v1"] += 1.0 * H2["c0,a0,v0,v1"] * T1["c1,a0"];
    C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
    C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
    temp["c0,c1,v0,v1"] += -1.0 * H1["a0,v0"] * T2["c0,c1,v1,a0"];
    temp["c0,c1,v0,v1"] += -1.0 * H2["c0,c1,v0,a0"] * T1["a0,v1"];
    C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
    C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];

    C2["c0,c1,v0,v1"] += 1.0 * H2["v2,a0,v0,v1"] * T2["c0,c1,v2,a0"];
    C2["c0,c1,v0,v1"] += (-1.0 / 2.0) * H2["c0,c1,a0,a1"] * T2["a0,a1,v0,v1"];
    C2["c0,c1,v0,v1"] += (1.0 / 2.0) * H2["a0,a1,v0,v1"] * T2["c0,c1,a0,a1"];
    C2["c0,c1,v0,v1"] += -1.0 * H2["v2,a0,v0,v1"] * T2["c0,c1,v2,a1"] * L1_["a1,a0"];
    C2["c0,c1,v0,v1"] += 1.0 * H2["c0,c1,c2,a0"] * T2["c2,a1,v0,v1"] * L1_["a0,a1"];
    C2["c0,c1,v0,v1"] += 1.0 * H2["c0,c1,a0,a1"] * T2["a0,a2,v0,v1"] * L1_["a1,a2"];
    C2["c0,c1,v0,v1"] += -1.0 * H2["a0,a1,v0,v1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
    temp["c0,a0,v0,v1"] += -1.0 * H1["c0,c1"] * T2["c1,a0,v0,v1"];
    temp["c0,a0,v0,v1"] += 1.0 * H1["c0,a1"] * T2["a0,a1,v0,v1"];
    temp["c0,a0,v0,v1"] += -1.0 * H1["a0,a1"] * T2["c0,a1,v0,v1"];
    temp["c0,a0,v0,v1"] += (1.0 / 2.0) * H2["v2,v3,v0,v1"] * T2["c0,a0,v2,v3"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["v2,c0,v0,v1"] * T1["a0,v2"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["v2,a1,v0,v1"] * T2["c0,a0,v2,a1"];
    temp["c0,a0,v0,v1"] += (-1.0 / 2.0) * H2["c0,a0,a1,a2"] * T2["a1,a2,v0,v1"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["a0,a1,v0,v1"] * T1["c0,a1"];
    temp["c0,a0,v0,v1"] += (1.0 / 2.0) * H2["a1,a2,v0,v1"] * T2["c0,a0,a1,a2"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["v2,a1,v0,v1"] * T2["c0,a0,v2,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["c0,a0,c1,a1"] * T2["c1,a2,v0,v1"] * L1_["a1,a2"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["c0,a0,a1,a2"] * T2["a1,a3,v0,v1"] * L1_["a2,a3"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["a1,a2,v0,v1"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
    C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
    temp["c0,a0,v0,v1"] += -1.0 * H1["v2,v0"] * T2["c0,a0,v1,v2"];
    temp["c0,a0,v0,v1"] += -1.0 * H1["a1,v0"] * T2["c0,a0,v1,a1"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["v2,c0,v0,c1"] * T2["c1,a0,v1,v2"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["c0,a0,v0,a1"] * T1["a1,v1"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["c0,a1,v0,c1"] * T2["c1,a0,v1,a1"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["a0,a1,v0,c1"] * T2["c0,c1,v1,a1"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["v2,c0,v0,a1"] * T2["a0,a2,v1,v2"] * L1_["a1,a2"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["v2,a0,v0,a1"] * T2["c0,a2,v1,v2"] * L1_["a1,a2"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["c0,a1,v0,c1"] * T2["c1,a0,v1,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["c0,a2,v0,a1"] * T2["a0,a1,v1,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["c0,a2,v0,a1"] * T2["a0,a3,v1,a2"] * L1_["a1,a3"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["a0,a1,v0,c1"] * T2["c0,c1,v1,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,v1"] += 1.0 * H2["a0,a2,v0,a1"] * T2["c0,a1,v1,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,v1"] += -1.0 * H2["a0,a2,v0,a1"] * T2["c0,a3,v1,a2"] * L1_["a1,a3"];
    C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
    C2["c0,a0,v1,v0"] -= temp["c0,a0,v0,v1"];
    C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];
    C2["a0,c0,v1,v0"] += temp["c0,a0,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavv"});
    temp["a0,a1,v0,v1"] += 1.0 * H2["v2,a0,v0,c0"] * T2["c0,a1,v1,v2"];
    temp["a0,a1,v0,v1"] += -1.0 * H2["a0,a2,v0,c0"] * T2["c0,a1,v1,a2"];
    temp["a0,a1,v0,v1"] += -1.0 * H2["v2,a0,v0,a2"] * T2["a1,a3,v1,v2"] * L1_["a2,a3"];
    temp["a0,a1,v0,v1"] += 1.0 * H2["a0,a2,v0,c0"] * T2["c0,a1,v1,a3"] * L1_["a3,a2"];
    temp["a0,a1,v0,v1"] += -1.0 * H2["a0,a3,v0,a2"] * T2["a1,a2,v1,a4"] * L1_["a4,a3"];
    temp["a0,a1,v0,v1"] += 1.0 * H2["a0,a3,v0,a2"] * T2["a1,a4,v1,a3"] * L1_["a2,a4"];
    C2["a0,a1,v0,v1"] += temp["a0,a1,v0,v1"];
    C2["a0,a1,v1,v0"] -= temp["a0,a1,v0,v1"];
    C2["a1,a0,v0,v1"] -= temp["a0,a1,v0,v1"];
    C2["a1,a0,v1,v0"] += temp["a0,a1,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavv"});
    temp["a0,a1,v0,v1"] += -1.0 * H1["v2,v0"] * T2["a0,a1,v1,v2"];
    temp["a0,a1,v0,v1"] += -1.0 * H1["a2,v0"] * T2["a0,a1,v1,a2"];
    temp["a0,a1,v0,v1"] += -1.0 * H2["a0,a1,v0,a2"] * T1["a2,v1"];
    C2["a0,a1,v0,v1"] += temp["a0,a1,v0,v1"];
    C2["a0,a1,v1,v0"] -= temp["a0,a1,v0,v1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavv"});
    temp["a0,a1,v0,v1"] += -1.0 * H1["a0,c0"] * T2["c0,a1,v0,v1"];
    temp["a0,a1,v0,v1"] += 1.0 * H1["a0,a2"] * T2["a1,a2,v0,v1"];
    temp["a0,a1,v0,v1"] += -1.0 * H2["v2,a0,v0,v1"] * T1["a1,v2"];
    C2["a0,a1,v0,v1"] += temp["a0,a1,v0,v1"];
    C2["a1,a0,v0,v1"] -= temp["a0,a1,v0,v1"];

    C2["a0,a1,v0,v1"] += (1.0 / 2.0) * H2["v2,v3,v0,v1"] * T2["a0,a1,v2,v3"];
    C2["a0,a1,v0,v1"] += 1.0 * H2["v2,a2,v0,v1"] * T2["a0,a1,v2,a2"];
    C2["a0,a1,v0,v1"] += (-1.0 / 2.0) * H2["a0,a1,a2,a3"] * T2["a2,a3,v0,v1"];
    C2["a0,a1,v0,v1"] += -1.0 * H2["v2,a2,v0,v1"] * T2["a0,a1,v2,a3"] * L1_["a3,a2"];
    C2["a0,a1,v0,v1"] += 1.0 * H2["a0,a1,c0,a2"] * T2["c0,a3,v0,v1"] * L1_["a2,a3"];
    C2["a0,a1,v0,v1"] += 1.0 * H2["a0,a1,a2,a3"] * T2["a2,a4,v0,v1"] * L1_["a3,a4"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavc"});
    temp["a0,a1,v0,c0"] += -1.0 * H2["v1,a0,v0,c0"] * T1["a1,v1"];
    temp["a0,a1,v0,c0"] += -1.0 * H2["v1,a0,c0,c1"] * T2["c1,a1,v0,v1"];
    temp["a0,a1,v0,c0"] += 1.0 * H2["a0,a2,c0,c1"] * T2["c1,a1,v0,a2"];
    temp["a0,a1,v0,c0"] += 1.0 * H2["v1,a0,c0,a2"] * T2["a1,a3,v0,v1"] * L1_["a2,a3"];
    temp["a0,a1,v0,c0"] += -1.0 * H2["a0,a2,c0,c1"] * T2["c1,a1,v0,a3"] * L1_["a3,a2"];
    temp["a0,a1,v0,c0"] += 1.0 * H2["a0,a3,c0,a2"] * T2["a1,a2,v0,a4"] * L1_["a4,a3"];
    temp["a0,a1,v0,c0"] += -1.0 * H2["a0,a3,c0,a2"] * T2["a1,a4,v0,a3"] * L1_["a2,a4"];
    C2["a0,a1,v0,c0"] += temp["a0,a1,v0,c0"];
    C2["a0,a1,c0,v0"] -= temp["a0,a1,v0,c0"];
    C2["a1,a0,v0,c0"] -= temp["a0,a1,v0,c0"];
    C2["a1,a0,c0,v0"] += temp["a0,a1,v0,c0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavc"});
    temp["a0,a1,v0,c0"] += 1.0 * H1["v1,c0"] * T2["a0,a1,v0,v1"];
    temp["a0,a1,v0,c0"] += 1.0 * H1["a2,c0"] * T2["a0,a1,v0,a2"];
    temp["a0,a1,v0,c0"] += (1.0 / 2.0) * H2["v1,v2,v0,c0"] * T2["a0,a1,v1,v2"];
    temp["a0,a1,v0,c0"] += 1.0 * H2["v1,a2,v0,c0"] * T2["a0,a1,v1,a2"];
    temp["a0,a1,v0,c0"] += 1.0 * H2["a0,a1,c0,a2"] * T1["a2,v0"];
    temp["a0,a1,v0,c0"] += -1.0 * H2["v1,a2,v0,c0"] * T2["a0,a1,v1,a3"] * L1_["a3,a2"];
    C2["a0,a1,v0,c0"] += temp["a0,a1,v0,c0"];
    C2["a0,a1,c0,v0"] -= temp["a0,a1,v0,c0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavc"});
    temp["c0,a0,v0,c1"] += 1.0 * H1["v1,c1"] * T2["c0,a0,v0,v1"];
    temp["c0,a0,v0,c1"] += 1.0 * H1["a1,c1"] * T2["c0,a0,v0,a1"];
    temp["c0,a0,v0,c1"] += (1.0 / 2.0) * H2["v1,v2,v0,c1"] * T2["c0,a0,v1,v2"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["v1,c0,v0,c1"] * T1["a0,v1"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["v1,c0,c1,c2"] * T2["c2,a0,v0,v1"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["v1,a1,v0,c1"] * T2["c0,a0,v1,a1"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["c0,a0,c1,a1"] * T1["a1,v0"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["c0,a1,c1,c2"] * T2["c2,a0,v0,a1"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["a0,a1,v0,c1"] * T1["c0,a1"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["a0,a1,c1,c2"] * T2["c0,c2,v0,a1"];
    temp["c0,a0,v0,c1"] += (1.0 / 2.0) * H2["a1,a2,v0,c1"] * T2["c0,a0,a1,a2"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["v1,c0,c1,a1"] * T2["a0,a2,v0,v1"] * L1_["a1,a2"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["v1,a0,c1,a1"] * T2["c0,a2,v0,v1"] * L1_["a1,a2"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["v1,a1,v0,c1"] * T2["c0,a0,v1,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["c0,a1,c1,c2"] * T2["c2,a0,v0,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["c0,a2,c1,a1"] * T2["a0,a1,v0,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["c0,a2,c1,a1"] * T2["a0,a3,v0,a2"] * L1_["a1,a3"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["a0,a1,c1,c2"] * T2["c0,c2,v0,a2"] * L1_["a2,a1"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["a0,a2,c1,a1"] * T2["c0,a1,v0,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,c1"] += 1.0 * H2["a0,a2,c1,a1"] * T2["c0,a3,v0,a2"] * L1_["a1,a3"];
    temp["c0,a0,v0,c1"] += -1.0 * H2["a1,a2,v0,c1"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    C2["c0,a0,v0,c1"] += temp["c0,a0,v0,c1"];
    C2["c0,a0,c1,v0"] -= temp["c0,a0,v0,c1"];
    C2["a0,c0,v0,c1"] -= temp["c0,a0,v0,c1"];
    C2["a0,c0,c1,v0"] += temp["c0,a0,v0,c1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
    temp["c0,c1,v0,c2"] += 1.0 * H2["c0,a0,v0,c2"] * T1["c1,a0"];
    temp["c0,c1,v0,c2"] += -1.0 * H2["c0,a0,c2,c3"] * T2["c1,c3,v0,a0"];
    temp["c0,c1,v0,c2"] += 1.0 * H2["v1,c0,c2,a0"] * T2["c1,a1,v0,v1"] * L1_["a0,a1"];
    temp["c0,c1,v0,c2"] += 1.0 * H2["c0,a0,c2,c3"] * T2["c1,c3,v0,a1"] * L1_["a1,a0"];
    temp["c0,c1,v0,c2"] += 1.0 * H2["c0,a1,c2,a0"] * T2["c1,a0,v0,a2"] * L1_["a2,a1"];
    temp["c0,c1,v0,c2"] += -1.0 * H2["c0,a1,c2,a0"] * T2["c1,a2,v0,a1"] * L1_["a0,a2"];
    C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
    C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];
    C2["c1,c0,v0,c2"] -= temp["c0,c1,v0,c2"];
    C2["c1,c0,c2,v0"] += temp["c0,c1,v0,c2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
    temp["c0,c1,v0,c2"] += 1.0 * H1["a0,c2"] * T2["c0,c1,v0,a0"];
    temp["c0,c1,v0,c2"] += 1.0 * H2["v1,a0,v0,c2"] * T2["c0,c1,v1,a0"];
    temp["c0,c1,v0,c2"] += 1.0 * H2["c0,c1,c2,a0"] * T1["a0,v0"];
    temp["c0,c1,v0,c2"] += (1.0 / 2.0) * H2["a0,a1,v0,c2"] * T2["c0,c1,a0,a1"];
    temp["c0,c1,v0,c2"] += -1.0 * H2["v1,a0,v0,c2"] * T2["c0,c1,v1,a1"] * L1_["a1,a0"];
    temp["c0,c1,v0,c2"] += -1.0 * H2["a0,a1,v0,c2"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
    C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
    temp["c0,c1,v0,a0"] += 1.0 * H1["c0,c2"] * T2["c1,c2,v0,a0"];
    temp["c0,c1,v0,a0"] += 1.0 * H1["c0,a1"] * T2["c1,a1,v0,a0"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["v1,c0,v0,c2"] * T2["c1,c2,v1,a0"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,a1,v0,c2"] * T2["c1,c2,a0,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,a1,v0,a0"] * T1["c1,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,a1,c2,a0"] * T2["c1,c2,v0,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["v1,c0,v0,a1"] * T2["c1,a2,v1,a0"] * L1_["a1,a2"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["v1,c0,a0,a1"] * T2["c1,a2,v0,v1"] * L1_["a1,a2"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["c0,a1,v0,c2"] * T2["c1,c2,a0,a2"] * L1_["a2,a1"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["c0,a1,c2,a0"] * T2["c1,c2,v0,a2"] * L1_["a2,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,a2,v0,a1"] * T2["c1,a3,a0,a2"] * L1_["a1,a3"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["c0,a2,v0,a1"] * T2["c1,a1,a0,a3"] * L1_["a3,a2"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,a2,a0,a1"] * T2["c1,a1,v0,a3"] * L1_["a3,a2"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["c0,a2,a0,a1"] * T2["c1,a3,v0,a2"] * L1_["a1,a3"];
    C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
    C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];
    C2["c1,c0,v0,a0"] -= temp["c0,c1,v0,a0"];
    C2["c1,c0,a0,v0"] += temp["c0,c1,v0,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
    temp["c0,c1,v0,a0"] += 1.0 * H1["v1,v0"] * T2["c0,c1,v1,a0"];
    temp["c0,c1,v0,a0"] += -1.0 * H1["a1,v0"] * T2["c0,c1,a0,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H1["a1,a0"] * T2["c0,c1,v0,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["v1,a1,v0,a0"] * T2["c0,c1,v1,a1"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["c0,c1,v0,c2"] * T1["c2,a0"];
    temp["c0,c1,v0,a0"] += (1.0 / 2.0) * H2["c0,c1,c2,c3"] * T2["c2,c3,v0,a0"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,c1,a0,a1"] * T1["a1,v0"];
    temp["c0,c1,v0,a0"] += (-1.0 / 2.0) * H2["c0,c1,a1,a2"] * T2["a1,a2,v0,a0"];
    temp["c0,c1,v0,a0"] += (1.0 / 2.0) * H2["a1,a2,v0,a0"] * T2["c0,c1,a1,a2"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["v1,a1,v0,a0"] * T2["c0,c1,v1,a2"] * L1_["a2,a1"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,c1,c2,a1"] * T2["c2,a2,v0,a0"] * L1_["a1,a2"];
    temp["c0,c1,v0,a0"] += 1.0 * H2["c0,c1,a1,a2"] * T2["a1,a3,v0,a0"] * L1_["a2,a3"];
    temp["c0,c1,v0,a0"] += -1.0 * H2["a1,a2,v0,a0"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
    C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cava"});
    temp["c0,a0,v0,a1"] += 1.0 * H1["v1,v0"] * T2["c0,a0,v1,a1"];
    temp["c0,a0,v0,a1"] += 1.0 * H1["v1,a1"] * T2["c0,a0,v0,v1"];
    temp["c0,a0,v0,a1"] += -1.0 * H1["c0,c1"] * T2["c1,a0,v0,a1"];
    temp["c0,a0,v0,a1"] += 1.0 * H1["c0,a2"] * T2["a0,a2,v0,a1"];
    temp["c0,a0,v0,a1"] += -1.0 * H1["a0,c1"] * T2["c0,c1,v0,a1"];
    temp["c0,a0,v0,a1"] += -1.0 * H1["a0,a2"] * T2["c0,a2,v0,a1"];
    temp["c0,a0,v0,a1"] += -1.0 * H1["a2,v0"] * T2["c0,a0,a1,a2"];
    temp["c0,a0,v0,a1"] += 1.0 * H1["a2,a1"] * T2["c0,a0,v0,a2"];
    temp["c0,a0,v0,a1"] += (1.0 / 2.0) * H2["v1,v2,v0,a1"] * T2["c0,a0,v1,v2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,c0,v0,c1"] * T2["c1,a0,v1,a1"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,c0,v0,a1"] * T1["a0,v1"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["v1,c0,c1,a1"] * T2["c1,a0,v0,v1"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,a0,v0,c1"] * T2["c0,c1,v1,a1"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["v1,a2,v0,a1"] * T2["c0,a0,v1,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["c0,a0,v0,c1"] * T1["c1,a1"];
    temp["c0,a0,v0,a1"] += (1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c1,c2,v0,a1"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a0,a1,a2"] * T1["a2,v0"];
    temp["c0,a0,v0,a1"] += (-1.0 / 2.0) * H2["c0,a0,a2,a3"] * T2["a2,a3,v0,a1"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["c0,a2,v0,c1"] * T2["c1,a0,a1,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["c0,a2,c1,a1"] * T2["c1,a0,v0,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a0,a2,v0,c1"] * T2["c0,c1,a1,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a0,a2,v0,a1"] * T1["c0,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a0,a2,c1,a1"] * T2["c0,c1,v0,a2"];
    temp["c0,a0,v0,a1"] += (1.0 / 2.0) * H2["a2,a3,v0,a1"] * T2["c0,a0,a2,a3"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["v1,c0,v0,a2"] * T2["a0,a3,v1,a1"] * L1_["a2,a3"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["v1,c0,a1,a2"] * T2["a0,a3,v0,v1"] * L1_["a2,a3"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,a0,v0,a2"] * T2["c0,a3,v1,a1"] * L1_["a2,a3"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,a0,a1,a2"] * T2["c0,a3,v0,v1"] * L1_["a2,a3"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["v1,a2,v0,a1"] * T2["c0,a0,v1,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a0,c1,a2"] * T2["c1,a3,v0,a1"] * L1_["a2,a3"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a0,a2,a3"] * T2["a2,a4,v0,a1"] * L1_["a3,a4"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a2,v0,c1"] * T2["c1,a0,a1,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a2,c1,a1"] * T2["c1,a0,v0,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["c0,a3,a1,a2"] * T2["a0,a2,v0,a4"] * L1_["a4,a3"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["c0,a3,a1,a2"] * T2["a0,a4,v0,a3"] * L1_["a2,a4"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["a0,a2,v0,c1"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["a0,a2,c1,a1"] * T2["c0,c1,v0,a3"] * L1_["a3,a2"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a0,a3,v0,a2"] * T2["c0,a4,a1,a3"] * L1_["a2,a4"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["a0,a3,v0,a2"] * T2["c0,a2,a1,a4"] * L1_["a4,a3"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a0,a3,a1,a2"] * T2["c0,a2,v0,a4"] * L1_["a4,a3"];
    temp["c0,a0,v0,a1"] += 1.0 * H2["a0,a3,a1,a2"] * T2["c0,a4,v0,a3"] * L1_["a2,a4"];
    temp["c0,a0,v0,a1"] += -1.0 * H2["a2,a3,v0,a1"] * T2["c0,a0,a2,a4"] * L1_["a4,a3"];
    C2["c0,a0,v0,a1"] += temp["c0,a0,v0,a1"];
    C2["c0,a0,a1,v0"] -= temp["c0,a0,v0,a1"];
    C2["a0,c0,v0,a1"] -= temp["c0,a0,v0,a1"];
    C2["a0,c0,a1,v0"] += temp["c0,a0,v0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aava"});
    temp["a0,a1,v0,a2"] += -1.0 * H1["a0,c0"] * T2["c0,a1,v0,a2"];
    temp["a0,a1,v0,a2"] += 1.0 * H1["a0,a3"] * T2["a1,a3,v0,a2"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["v1,a0,v0,c0"] * T2["c0,a1,v1,a2"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["v1,a0,v0,a2"] * T1["a1,v1"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["v1,a0,c0,a2"] * T2["c0,a1,v0,v1"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["a0,a3,v0,c0"] * T2["c0,a1,a2,a3"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["a0,a3,c0,a2"] * T2["c0,a1,v0,a3"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["v1,a0,v0,a3"] * T2["a1,a4,v1,a2"] * L1_["a3,a4"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["v1,a0,a2,a3"] * T2["a1,a4,v0,v1"] * L1_["a3,a4"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a3,v0,c0"] * T2["c0,a1,a2,a4"] * L1_["a4,a3"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a3,c0,a2"] * T2["c0,a1,v0,a4"] * L1_["a4,a3"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a4,a2,a3"] * T2["a1,a3,v0,a5"] * L1_["a5,a4"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["a0,a4,a2,a3"] * T2["a1,a5,v0,a4"] * L1_["a3,a5"];
    C2["a0,a1,v0,a2"] += temp["a0,a1,v0,a2"];
    C2["a0,a1,a2,v0"] -= temp["a0,a1,v0,a2"];
    C2["a1,a0,v0,a2"] -= temp["a0,a1,v0,a2"];
    C2["a1,a0,a2,v0"] += temp["a0,a1,v0,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aava"});
    temp["a0,a1,v0,a2"] += 1.0 * H1["v1,v0"] * T2["a0,a1,v1,a2"];
    temp["a0,a1,v0,a2"] += 1.0 * H1["v1,a2"] * T2["a0,a1,v0,v1"];
    temp["a0,a1,v0,a2"] += 1.0 * H1["a3,a2"] * T2["a0,a1,v0,a3"];
    temp["a0,a1,v0,a2"] += (1.0 / 2.0) * H2["v1,v2,v0,a2"] * T2["a0,a1,v1,v2"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["v1,a3,v0,a2"] * T2["a0,a1,v1,a3"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["a0,a1,v0,c0"] * T1["c0,a2"];
    temp["a0,a1,v0,a2"] += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,v0,a2"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a1,a2,a3"] * T1["a3,v0"];
    temp["a0,a1,v0,a2"] += (-1.0 / 2.0) * H2["a0,a1,a3,a4"] * T2["a3,a4,v0,a2"];
    temp["a0,a1,v0,a2"] += -1.0 * H2["v1,a3,v0,a2"] * T2["a0,a1,v1,a4"] * L1_["a4,a3"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a1,c0,a3"] * T2["c0,a4,v0,a2"] * L1_["a3,a4"];
    temp["a0,a1,v0,a2"] += 1.0 * H2["a0,a1,a3,a4"] * T2["a3,a5,v0,a2"] * L1_["a4,a5"];
    C2["a0,a1,v0,a2"] += temp["a0,a1,v0,a2"];
    C2["a0,a1,a2,v0"] -= temp["a0,a1,v0,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
    temp["v0,c0,v1,v2"] += -1.0 * H2["v0,c0,v1,a0"] * T1["a0,v2"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,a0,v1,c1"] * T2["c0,c1,v2,a0"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,v3,v1,a0"] * T2["c0,a1,v2,v3"] * L1_["a0,a1"];
    temp["v0,c0,v1,v2"] += -1.0 * H2["v0,a0,v1,c1"] * T2["c0,c1,v2,a1"] * L1_["a1,a0"];
    temp["v0,c0,v1,v2"] += -1.0 * H2["v0,a1,v1,a0"] * T2["c0,a0,v2,a2"] * L1_["a2,a1"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,a1,v1,a0"] * T2["c0,a2,v2,a1"] * L1_["a0,a2"];
    C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
    C2["v0,c0,v2,v1"] -= temp["v0,c0,v1,v2"];
    C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];
    C2["c0,v0,v2,v1"] += temp["v0,c0,v1,v2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
    temp["v0,c0,v1,v2"] += 1.0 * H1["v0,a0"] * T2["c0,a0,v1,v2"];
    temp["v0,c0,v1,v2"] += (-1.0 / 2.0) * H2["v0,c0,a0,a1"] * T2["a0,a1,v1,v2"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,a0,v1,v2"] * T1["c0,a0"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,c0,c1,a0"] * T2["c1,a1,v1,v2"] * L1_["a0,a1"];
    temp["v0,c0,v1,v2"] += 1.0 * H2["v0,c0,a0,a1"] * T2["a0,a2,v1,v2"] * L1_["a1,a2"];
    C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
    C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavv"});
    temp["v0,a0,v1,v2"] += -1.0 * H2["v0,v3,v1,c0"] * T2["c0,a0,v2,v3"];
    temp["v0,a0,v1,v2"] += -1.0 * H2["v0,a0,v1,a1"] * T1["a1,v2"];
    temp["v0,a0,v1,v2"] += -1.0 * H2["v0,a1,v1,c0"] * T2["c0,a0,v2,a1"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,v3,v1,a1"] * T2["a0,a2,v2,v3"] * L1_["a1,a2"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,a1,v1,c0"] * T2["c0,a0,v2,a2"] * L1_["a2,a1"];
    temp["v0,a0,v1,v2"] += -1.0 * H2["v0,a2,v1,a1"] * T2["a0,a1,v2,a3"] * L1_["a3,a2"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,a2,v1,a1"] * T2["a0,a3,v2,a2"] * L1_["a1,a3"];
    C2["v0,a0,v1,v2"] += temp["v0,a0,v1,v2"];
    C2["v0,a0,v2,v1"] -= temp["v0,a0,v1,v2"];
    C2["a0,v0,v1,v2"] -= temp["v0,a0,v1,v2"];
    C2["a0,v0,v2,v1"] += temp["v0,a0,v1,v2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavv"});
    temp["v0,a0,v1,v2"] += -1.0 * H1["v0,c0"] * T2["c0,a0,v1,v2"];
    temp["v0,a0,v1,v2"] += 1.0 * H1["v0,a1"] * T2["a0,a1,v1,v2"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,v3,v1,v2"] * T1["a0,v3"];
    temp["v0,a0,v1,v2"] += (-1.0 / 2.0) * H2["v0,a0,a1,a2"] * T2["a1,a2,v1,v2"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,a0,c0,a1"] * T2["c0,a2,v1,v2"] * L1_["a1,a2"];
    temp["v0,a0,v1,v2"] += 1.0 * H2["v0,a0,a1,a2"] * T2["a1,a3,v1,v2"] * L1_["a2,a3"];
    C2["v0,a0,v1,v2"] += temp["v0,a0,v1,v2"];
    C2["a0,v0,v1,v2"] -= temp["v0,a0,v1,v2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavc"});
    temp["v0,a0,v1,c0"] += 1.0 * H2["v0,v2,v1,c0"] * T1["a0,v2"];
    temp["v0,a0,v1,c0"] += 1.0 * H2["v0,v2,c0,c1"] * T2["c1,a0,v1,v2"];
    temp["v0,a0,v1,c0"] += 1.0 * H2["v0,a0,c0,a1"] * T1["a1,v1"];
    temp["v0,a0,v1,c0"] += 1.0 * H2["v0,a1,c0,c1"] * T2["c1,a0,v1,a1"];
    temp["v0,a0,v1,c0"] += -1.0 * H2["v0,v2,c0,a1"] * T2["a0,a2,v1,v2"] * L1_["a1,a2"];
    temp["v0,a0,v1,c0"] += -1.0 * H2["v0,a1,c0,c1"] * T2["c1,a0,v1,a2"] * L1_["a2,a1"];
    temp["v0,a0,v1,c0"] += 1.0 * H2["v0,a2,c0,a1"] * T2["a0,a1,v1,a3"] * L1_["a3,a2"];
    temp["v0,a0,v1,c0"] += -1.0 * H2["v0,a2,c0,a1"] * T2["a0,a3,v1,a2"] * L1_["a1,a3"];
    C2["v0,a0,v1,c0"] += temp["v0,a0,v1,c0"];
    C2["v0,a0,c0,v1"] -= temp["v0,a0,v1,c0"];
    C2["a0,v0,v1,c0"] -= temp["v0,a0,v1,c0"];
    C2["a0,v0,c0,v1"] += temp["v0,a0,v1,c0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvc"});
    temp["v0,c0,v1,c1"] += 1.0 * H2["v0,c0,c1,a0"] * T1["a0,v1"];
    temp["v0,c0,v1,c1"] += 1.0 * H2["v0,a0,v1,c1"] * T1["c0,a0"];
    temp["v0,c0,v1,c1"] += -1.0 * H2["v0,a0,c1,c2"] * T2["c0,c2,v1,a0"];
    temp["v0,c0,v1,c1"] += -1.0 * H2["v0,v2,c1,a0"] * T2["c0,a1,v1,v2"] * L1_["a0,a1"];
    temp["v0,c0,v1,c1"] += 1.0 * H2["v0,a0,c1,c2"] * T2["c0,c2,v1,a1"] * L1_["a1,a0"];
    temp["v0,c0,v1,c1"] += 1.0 * H2["v0,a1,c1,a0"] * T2["c0,a0,v1,a2"] * L1_["a2,a1"];
    temp["v0,c0,v1,c1"] += -1.0 * H2["v0,a1,c1,a0"] * T2["c0,a2,v1,a1"] * L1_["a0,a2"];
    C2["v0,c0,v1,c1"] += temp["v0,c0,v1,c1"];
    C2["v0,c0,c1,v1"] -= temp["v0,c0,v1,c1"];
    C2["c0,v0,v1,c1"] -= temp["v0,c0,v1,c1"];
    C2["c0,v0,c1,v1"] += temp["v0,c0,v1,c1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcva"});
    temp["v0,c0,v1,a0"] += 1.0 * H1["v0,c1"] * T2["c0,c1,v1,a0"];
    temp["v0,c0,v1,a0"] += 1.0 * H1["v0,a1"] * T2["c0,a1,v1,a0"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,v2,v1,c1"] * T2["c0,c1,v2,a0"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,c0,v1,c1"] * T1["c1,a0"];
    temp["v0,c0,v1,a0"] += (1.0 / 2.0) * H2["v0,c0,c1,c2"] * T2["c1,c2,v1,a0"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,c0,a0,a1"] * T1["a1,v1"];
    temp["v0,c0,v1,a0"] += (-1.0 / 2.0) * H2["v0,c0,a1,a2"] * T2["a1,a2,v1,a0"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,a1,v1,c1"] * T2["c0,c1,a0,a1"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,a1,v1,a0"] * T1["c0,a1"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,a1,c1,a0"] * T2["c0,c1,v1,a1"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,v2,v1,a1"] * T2["c0,a2,v2,a0"] * L1_["a1,a2"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,v2,a0,a1"] * T2["c0,a2,v1,v2"] * L1_["a1,a2"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,c0,c1,a1"] * T2["c1,a2,v1,a0"] * L1_["a1,a2"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,c0,a1,a2"] * T2["a1,a3,v1,a0"] * L1_["a2,a3"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,a1,v1,c1"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,a1,c1,a0"] * T2["c0,c1,v1,a2"] * L1_["a2,a1"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,a2,v1,a1"] * T2["c0,a3,a0,a2"] * L1_["a1,a3"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,a2,v1,a1"] * T2["c0,a1,a0,a3"] * L1_["a3,a2"];
    temp["v0,c0,v1,a0"] += 1.0 * H2["v0,a2,a0,a1"] * T2["c0,a1,v1,a3"] * L1_["a3,a2"];
    temp["v0,c0,v1,a0"] += -1.0 * H2["v0,a2,a0,a1"] * T2["c0,a3,v1,a2"] * L1_["a1,a3"];
    C2["v0,c0,v1,a0"] += temp["v0,c0,v1,a0"];
    C2["v0,c0,a0,v1"] -= temp["v0,c0,v1,a0"];
    C2["c0,v0,v1,a0"] -= temp["v0,c0,v1,a0"];
    C2["c0,v0,a0,v1"] += temp["v0,c0,v1,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vava"});
    temp["v0,a0,v1,a1"] += -1.0 * H1["v0,c0"] * T2["c0,a0,v1,a1"];
    temp["v0,a0,v1,a1"] += 1.0 * H1["v0,a2"] * T2["a0,a2,v1,a1"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,v2,v1,c0"] * T2["c0,a0,v2,a1"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,v2,v1,a1"] * T1["a0,v2"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,v2,c0,a1"] * T2["c0,a0,v1,v2"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,a0,v1,c0"] * T1["c0,a1"];
    temp["v0,a0,v1,a1"] += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v1,a1"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a0,a1,a2"] * T1["a2,v1"];
    temp["v0,a0,v1,a1"] += (-1.0 / 2.0) * H2["v0,a0,a2,a3"] * T2["a2,a3,v1,a1"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,a2,v1,c0"] * T2["c0,a0,a1,a2"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,a2,c0,a1"] * T2["c0,a0,v1,a2"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,v2,v1,a2"] * T2["a0,a3,v2,a1"] * L1_["a2,a3"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,v2,a1,a2"] * T2["a0,a3,v1,v2"] * L1_["a2,a3"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a0,c0,a2"] * T2["c0,a3,v1,a1"] * L1_["a2,a3"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a0,a2,a3"] * T2["a2,a4,v1,a1"] * L1_["a3,a4"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a2,v1,c0"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a2,c0,a1"] * T2["c0,a0,v1,a3"] * L1_["a3,a2"];
    temp["v0,a0,v1,a1"] += 1.0 * H2["v0,a3,a1,a2"] * T2["a0,a2,v1,a4"] * L1_["a4,a3"];
    temp["v0,a0,v1,a1"] += -1.0 * H2["v0,a3,a1,a2"] * T2["a0,a4,v1,a3"] * L1_["a2,a4"];
    C2["v0,a0,v1,a1"] += temp["v0,a0,v1,a1"];
    C2["v0,a0,a1,v1"] -= temp["v0,a0,v1,a1"];
    C2["a0,v0,v1,a1"] -= temp["v0,a0,v1,a1"];
    C2["a0,v0,a1,v1"] += temp["v0,a0,v1,a1"];

    C2["v0,v1,v2,v3"] += (-1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a0,a1,v2,v3"];
    C2["v0,v1,v2,v3"] += 1.0 * H2["v0,v1,c0,a0"] * T2["c0,a1,v2,v3"] * L1_["a0,a1"];
    C2["v0,v1,v2,v3"] += 1.0 * H2["v0,v1,a0,a1"] * T2["a0,a2,v2,v3"] * L1_["a1,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvvv"});
    temp["v0,v1,v2,v3"] += -1.0 * H2["v0,v1,v2,a0"] * T1["a0,v3"];
    C2["v0,v1,v2,v3"] += temp["v0,v1,v2,v3"];
    C2["v0,v1,v3,v2"] -= temp["v0,v1,v2,v3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvvc"});
    temp["v0,v1,v2,c0"] += 1.0 * H2["v0,v1,c0,a0"] * T1["a0,v2"];
    C2["v0,v1,v2,c0"] += temp["v0,v1,v2,c0"];
    C2["v0,v1,c0,v2"] -= temp["v0,v1,v2,c0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvva"});
    temp["v0,v1,v2,a0"] += -1.0 * H2["v0,v1,v2,c0"] * T1["c0,a0"];
    temp["v0,v1,v2,a0"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,v2,a0"];
    temp["v0,v1,v2,a0"] += 1.0 * H2["v0,v1,a0,a1"] * T1["a1,v2"];
    temp["v0,v1,v2,a0"] += (-1.0 / 2.0) * H2["v0,v1,a1,a2"] * T2["a1,a2,v2,a0"];
    temp["v0,v1,v2,a0"] += 1.0 * H2["v0,v1,c0,a1"] * T2["c0,a2,v2,a0"] * L1_["a1,a2"];
    temp["v0,v1,v2,a0"] += 1.0 * H2["v0,v1,a1,a2"] * T2["a1,a3,v2,a0"] * L1_["a2,a3"];
    C2["v0,v1,v2,a0"] += temp["v0,v1,v2,a0"];
    C2["v0,v1,a0,v2"] -= temp["v0,v1,v2,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vacc"});
    temp["v0,a0,c0,c1"] += 1.0 * H2["v0,v1,c0,c1"] * T1["a0,v1"];
    C2["v0,a0,c0,c1"] += temp["v0,a0,c0,c1"];
    C2["a0,v0,c0,c1"] -= temp["v0,a0,c0,c1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aacc"});
    temp["a0,a1,c0,c1"] += -1.0 * H2["v0,a0,c0,c1"] * T1["a1,v0"];
    C2["a0,a1,c0,c1"] += temp["a0,a1,c0,c1"];
    C2["a1,a0,c0,c1"] -= temp["a0,a1,c0,c1"];

    C2["a0,a1,c0,c1"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["a0,a1,v0,v1"];
    C2["a0,a1,c0,c1"] += 1.0 * H2["v0,a2,c0,c1"] * T2["a0,a1,v0,a2"];
    C2["a0,a1,c0,c1"] += -1.0 * H2["v0,a2,c0,c1"] * T2["a0,a1,v0,a3"] * L1_["a3,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvca"});
    temp["v0,v1,c0,a0"] += -1.0 * H2["v0,v1,c0,c1"] * T1["c1,a0"];
    C2["v0,v1,c0,a0"] += temp["v0,v1,c0,a0"];
    C2["v0,v1,a0,c0"] -= temp["v0,v1,c0,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vaca"});
    temp["v0,a0,c0,a1"] += 1.0 * H2["v0,v1,c0,c1"] * T2["c1,a0,v1,a1"];
    temp["v0,a0,c0,a1"] += 1.0 * H2["v0,v1,c0,a1"] * T1["a0,v1"];
    temp["v0,a0,c0,a1"] += -1.0 * H2["v0,a0,c0,c1"] * T1["c1,a1"];
    temp["v0,a0,c0,a1"] += -1.0 * H2["v0,a2,c0,c1"] * T2["c1,a0,a1,a2"];
    temp["v0,a0,c0,a1"] += -1.0 * H2["v0,v1,c0,a2"] * T2["a0,a3,v1,a1"] * L1_["a2,a3"];
    temp["v0,a0,c0,a1"] += 1.0 * H2["v0,a2,c0,c1"] * T2["c1,a0,a1,a3"] * L1_["a3,a2"];
    C2["v0,a0,c0,a1"] += temp["v0,a0,c0,a1"];
    C2["v0,a0,a1,c0"] -= temp["v0,a0,c0,a1"];
    C2["a0,v0,c0,a1"] -= temp["v0,a0,c0,a1"];
    C2["a0,v0,a1,c0"] += temp["v0,a0,c0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aaca"});
    temp["a0,a1,c0,a2"] += -1.0 * H2["v0,a0,c0,c1"] * T2["c1,a1,v0,a2"];
    temp["a0,a1,c0,a2"] += -1.0 * H2["v0,a0,c0,a2"] * T1["a1,v0"];
    temp["a0,a1,c0,a2"] += -1.0 * H2["a0,a3,c0,c1"] * T2["c1,a1,a2,a3"];
    temp["a0,a1,c0,a2"] += 1.0 * H2["v0,a0,c0,a3"] * T2["a1,a4,v0,a2"] * L1_["a3,a4"];
    temp["a0,a1,c0,a2"] += 1.0 * H2["a0,a3,c0,c1"] * T2["c1,a1,a2,a4"] * L1_["a4,a3"];
    C2["a0,a1,c0,a2"] += temp["a0,a1,c0,a2"];
    C2["a0,a1,a2,c0"] -= temp["a0,a1,c0,a2"];
    C2["a1,a0,c0,a2"] -= temp["a0,a1,c0,a2"];
    C2["a1,a0,a2,c0"] += temp["a0,a1,c0,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aaca"});
    temp["a0,a1,c0,a2"] += 1.0 * H1["v0,c0"] * T2["a0,a1,v0,a2"];
    temp["a0,a1,c0,a2"] += (1.0 / 2.0) * H2["v0,v1,c0,a2"] * T2["a0,a1,v0,v1"];
    temp["a0,a1,c0,a2"] += 1.0 * H2["v0,a3,c0,a2"] * T2["a0,a1,v0,a3"];
    temp["a0,a1,c0,a2"] += -1.0 * H2["a0,a1,c0,c1"] * T1["c1,a2"];
    temp["a0,a1,c0,a2"] += -1.0 * H2["v0,a3,c0,a2"] * T2["a0,a1,v0,a4"] * L1_["a4,a3"];
    C2["a0,a1,c0,a2"] += temp["a0,a1,c0,a2"];
    C2["a0,a1,a2,c0"] -= temp["a0,a1,c0,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vccc"});
    temp["v0,c0,c1,c2"] += 1.0 * H2["v0,a0,c1,c2"] * T1["c0,a0"];
    C2["v0,c0,c1,c2"] += temp["v0,c0,c1,c2"];
    C2["c0,v0,c1,c2"] -= temp["v0,c0,c1,c2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cacc"});
    temp["c0,a0,c1,c2"] += (1.0 / 2.0) * H2["v0,v1,c1,c2"] * T2["c0,a0,v0,v1"];
    temp["c0,a0,c1,c2"] += -1.0 * H2["v0,c0,c1,c2"] * T1["a0,v0"];
    temp["c0,a0,c1,c2"] += 1.0 * H2["v0,a1,c1,c2"] * T2["c0,a0,v0,a1"];
    temp["c0,a0,c1,c2"] += -1.0 * H2["a0,a1,c1,c2"] * T1["c0,a1"];
    temp["c0,a0,c1,c2"] += (1.0 / 2.0) * H2["a1,a2,c1,c2"] * T2["c0,a0,a1,a2"];
    temp["c0,a0,c1,c2"] += -1.0 * H2["v0,a1,c1,c2"] * T2["c0,a0,v0,a2"] * L1_["a2,a1"];
    temp["c0,a0,c1,c2"] += -1.0 * H2["a1,a2,c1,c2"] * T2["c0,a0,a1,a3"] * L1_["a3,a2"];
    C2["c0,a0,c1,c2"] += temp["c0,a0,c1,c2"];
    C2["a0,c0,c1,c2"] -= temp["c0,a0,c1,c2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcca"});
    temp["v0,c0,c1,a0"] += -1.0 * H2["v0,v1,c1,c2"] * T2["c0,c2,v1,a0"];
    temp["v0,c0,c1,a0"] += -1.0 * H2["v0,c0,c1,c2"] * T1["c2,a0"];
    temp["v0,c0,c1,a0"] += 1.0 * H2["v0,a1,c1,c2"] * T2["c0,c2,a0,a1"];
    temp["v0,c0,c1,a0"] += 1.0 * H2["v0,a1,c1,a0"] * T1["c0,a1"];
    temp["v0,c0,c1,a0"] += -1.0 * H2["v0,v1,c1,a1"] * T2["c0,a2,v1,a0"] * L1_["a1,a2"];
    temp["v0,c0,c1,a0"] += -1.0 * H2["v0,a1,c1,c2"] * T2["c0,c2,a0,a2"] * L1_["a2,a1"];
    temp["v0,c0,c1,a0"] += 1.0 * H2["v0,a2,c1,a1"] * T2["c0,a3,a0,a2"] * L1_["a1,a3"];
    temp["v0,c0,c1,a0"] += -1.0 * H2["v0,a2,c1,a1"] * T2["c0,a1,a0,a3"] * L1_["a3,a2"];
    C2["v0,c0,c1,a0"] += temp["v0,c0,c1,a0"];
    C2["v0,c0,a0,c1"] -= temp["v0,c0,c1,a0"];
    C2["c0,v0,c1,a0"] -= temp["v0,c0,c1,a0"];
    C2["c0,v0,a0,c1"] += temp["v0,c0,c1,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"caca"});
    temp["c0,a0,c1,a1"] += 1.0 * H1["v0,c1"] * T2["c0,a0,v0,a1"];
    temp["c0,a0,c1,a1"] += -1.0 * H1["a2,c1"] * T2["c0,a0,a1,a2"];
    temp["c0,a0,c1,a1"] += (1.0 / 2.0) * H2["v0,v1,c1,a1"] * T2["c0,a0,v0,v1"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["v0,c0,c1,c2"] * T2["c2,a0,v0,a1"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["v0,c0,c1,a1"] * T1["a0,v0"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["v0,a0,c1,c2"] * T2["c0,c2,v0,a1"];
    temp["c0,a0,c1,a1"] += 1.0 * H2["v0,a2,c1,a1"] * T2["c0,a0,v0,a2"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["c0,a0,c1,c2"] * T1["c2,a1"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["c0,a2,c1,c2"] * T2["c2,a0,a1,a2"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["a0,a2,c1,c2"] * T2["c0,c2,a1,a2"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["a0,a2,c1,a1"] * T1["c0,a2"];
    temp["c0,a0,c1,a1"] += (1.0 / 2.0) * H2["a2,a3,c1,a1"] * T2["c0,a0,a2,a3"];
    temp["c0,a0,c1,a1"] += 1.0 * H2["v0,c0,c1,a2"] * T2["a0,a3,v0,a1"] * L1_["a2,a3"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["v0,a0,c1,a2"] * T2["c0,a3,v0,a1"] * L1_["a2,a3"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["v0,a2,c1,a1"] * T2["c0,a0,v0,a3"] * L1_["a3,a2"];
    temp["c0,a0,c1,a1"] += 1.0 * H2["c0,a2,c1,c2"] * T2["c2,a0,a1,a3"] * L1_["a3,a2"];
    temp["c0,a0,c1,a1"] += 1.0 * H2["a0,a2,c1,c2"] * T2["c0,c2,a1,a3"] * L1_["a3,a2"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["a0,a3,c1,a2"] * T2["c0,a4,a1,a3"] * L1_["a2,a4"];
    temp["c0,a0,c1,a1"] += 1.0 * H2["a0,a3,c1,a2"] * T2["c0,a2,a1,a4"] * L1_["a4,a3"];
    temp["c0,a0,c1,a1"] += -1.0 * H2["a2,a3,c1,a1"] * T2["c0,a0,a2,a4"] * L1_["a4,a3"];
    C2["c0,a0,c1,a1"] += temp["c0,a0,c1,a1"];
    C2["c0,a0,a1,c1"] -= temp["c0,a0,c1,a1"];
    C2["a0,c0,c1,a1"] -= temp["c0,a0,c1,a1"];
    C2["a0,c0,a1,c1"] += temp["c0,a0,c1,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cccc"});
    temp["c0,c1,c2,c3"] += 1.0 * H2["c0,a0,c2,c3"] * T1["c1,a0"];
    C2["c0,c1,c2,c3"] += temp["c0,c1,c2,c3"];
    C2["c1,c0,c2,c3"] -= temp["c0,c1,c2,c3"];

    C2["c0,c1,c2,c3"] += 1.0 * H2["v0,a0,c2,c3"] * T2["c0,c1,v0,a0"];
    C2["c0,c1,c2,c3"] += (1.0 / 2.0) * H2["a0,a1,c2,c3"] * T2["c0,c1,a0,a1"];
    C2["c0,c1,c2,c3"] += -1.0 * H2["v0,a0,c2,c3"] * T2["c0,c1,v0,a1"] * L1_["a1,a0"];
    C2["c0,c1,c2,c3"] += -1.0 * H2["a0,a1,c2,c3"] * T2["c0,c1,a0,a2"] * L1_["a2,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccca"});
    temp["c0,c1,c2,a0"] += 1.0 * H2["v0,c0,c2,c3"] * T2["c1,c3,v0,a0"];
    temp["c0,c1,c2,a0"] += 1.0 * H2["c0,a1,c2,c3"] * T2["c1,c3,a0,a1"];
    temp["c0,c1,c2,a0"] += 1.0 * H2["c0,a1,c2,a0"] * T1["c1,a1"];
    temp["c0,c1,c2,a0"] += 1.0 * H2["v0,c0,c2,a1"] * T2["c1,a2,v0,a0"] * L1_["a1,a2"];
    temp["c0,c1,c2,a0"] += -1.0 * H2["c0,a1,c2,c3"] * T2["c1,c3,a0,a2"] * L1_["a2,a1"];
    temp["c0,c1,c2,a0"] += 1.0 * H2["c0,a2,c2,a1"] * T2["c1,a3,a0,a2"] * L1_["a1,a3"];
    temp["c0,c1,c2,a0"] += -1.0 * H2["c0,a2,c2,a1"] * T2["c1,a1,a0,a3"] * L1_["a3,a2"];
    C2["c0,c1,c2,a0"] += temp["c0,c1,c2,a0"];
    C2["c0,c1,a0,c2"] -= temp["c0,c1,c2,a0"];
    C2["c1,c0,c2,a0"] -= temp["c0,c1,c2,a0"];
    C2["c1,c0,a0,c2"] += temp["c0,c1,c2,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccca"});
    temp["c0,c1,c2,a0"] += 1.0 * H1["v0,c2"] * T2["c0,c1,v0,a0"];
    temp["c0,c1,c2,a0"] += -1.0 * H1["a1,c2"] * T2["c0,c1,a0,a1"];
    temp["c0,c1,c2,a0"] += 1.0 * H2["v0,a1,c2,a0"] * T2["c0,c1,v0,a1"];
    temp["c0,c1,c2,a0"] += -1.0 * H2["c0,c1,c2,c3"] * T1["c3,a0"];
    temp["c0,c1,c2,a0"] += (1.0 / 2.0) * H2["a1,a2,c2,a0"] * T2["c0,c1,a1,a2"];
    temp["c0,c1,c2,a0"] += -1.0 * H2["v0,a1,c2,a0"] * T2["c0,c1,v0,a2"] * L1_["a2,a1"];
    temp["c0,c1,c2,a0"] += -1.0 * H2["a1,a2,c2,a0"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    C2["c0,c1,c2,a0"] += temp["c0,c1,c2,a0"];
    C2["c0,c1,a0,c2"] -= temp["c0,c1,c2,a0"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvaa"});
    temp["v0,v1,a0,a1"] += 1.0 * H2["v0,v1,c0,a0"] * T1["c0,a1"];
    C2["v0,v1,a0,a1"] += temp["v0,v1,a0,a1"];
    C2["v0,v1,a1,a0"] -= temp["v0,v1,a0,a1"];

    C2["v0,v1,a0,a1"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,a0,a1"];
    C2["v0,v1,a0,a1"] += 1.0 * H2["v0,v1,c0,a2"] * T2["c0,a3,a0,a1"] * L1_["a2,a3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcaa"});
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,v1,c1,a0"] * T2["c0,c1,v1,a1"];
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,c0,c1,a0"] * T1["c1,a1"];
    temp["v0,c0,a0,a1"] += -1.0 * H2["v0,a2,c1,a0"] * T2["c0,c1,a1,a2"];
    temp["v0,c0,a0,a1"] += -1.0 * H2["v0,v1,a0,a2"] * T2["c0,a3,v1,a1"] * L1_["a2,a3"];
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,a2,c1,a0"] * T2["c0,c1,a1,a3"] * L1_["a3,a2"];
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,a3,a0,a2"] * T2["c0,a4,a1,a3"] * L1_["a2,a4"];
    temp["v0,c0,a0,a1"] += -1.0 * H2["v0,a3,a0,a2"] * T2["c0,a2,a1,a4"] * L1_["a4,a3"];
    C2["v0,c0,a0,a1"] += temp["v0,c0,a0,a1"];
    C2["v0,c0,a1,a0"] -= temp["v0,c0,a0,a1"];
    C2["c0,v0,a0,a1"] -= temp["v0,c0,a0,a1"];
    C2["c0,v0,a1,a0"] += temp["v0,c0,a0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcaa"});
    temp["v0,c0,a0,a1"] += 1.0 * H1["v0,c1"] * T2["c0,c1,a0,a1"];
    temp["v0,c0,a0,a1"] += 1.0 * H1["v0,a2"] * T2["c0,a2,a0,a1"];
    temp["v0,c0,a0,a1"] += (1.0 / 2.0) * H2["v0,c0,c1,c2"] * T2["c1,c2,a0,a1"];
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,a2,a0,a1"] * T1["c0,a2"];
    temp["v0,c0,a0,a1"] += 1.0 * H2["v0,c0,c1,a2"] * T2["c1,a3,a0,a1"] * L1_["a2,a3"];
    C2["v0,c0,a0,a1"] += temp["v0,c0,a0,a1"];
    C2["c0,v0,a0,a1"] -= temp["v0,c0,a0,a1"];

    C2["c0,c1,a0,a1"] += 1.0 * H2["v0,a2,a0,a1"] * T2["c0,c1,v0,a2"];
    C2["c0,c1,a0,a1"] += (1.0 / 2.0) * H2["c0,c1,c2,c3"] * T2["c2,c3,a0,a1"];
    C2["c0,c1,a0,a1"] += (1.0 / 2.0) * H2["a2,a3,a0,a1"] * T2["c0,c1,a2,a3"];
    C2["c0,c1,a0,a1"] += -1.0 * H2["v0,a2,a0,a1"] * T2["c0,c1,v0,a3"] * L1_["a3,a2"];
    C2["c0,c1,a0,a1"] += 1.0 * H2["c0,c1,c2,a2"] * T2["c2,a3,a0,a1"] * L1_["a2,a3"];
    C2["c0,c1,a0,a1"] += -1.0 * H2["a2,a3,a0,a1"] * T2["c0,c1,a2,a4"] * L1_["a4,a3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccaa"});
    temp["c0,c1,a0,a1"] += 1.0 * H1["v0,a0"] * T2["c0,c1,v0,a1"];
    temp["c0,c1,a0,a1"] += -1.0 * H1["a2,a0"] * T2["c0,c1,a1,a2"];
    temp["c0,c1,a0,a1"] += 1.0 * H2["c0,c1,c2,a0"] * T1["c2,a1"];
    C2["c0,c1,a0,a1"] += temp["c0,c1,a0,a1"];
    C2["c0,c1,a1,a0"] -= temp["c0,c1,a0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccaa"});
    temp["c0,c1,a0,a1"] += 1.0 * H1["c0,c2"] * T2["c1,c2,a0,a1"];
    temp["c0,c1,a0,a1"] += 1.0 * H1["c0,a2"] * T2["c1,a2,a0,a1"];
    temp["c0,c1,a0,a1"] += 1.0 * H2["c0,a2,a0,a1"] * T1["c1,a2"];
    C2["c0,c1,a0,a1"] += temp["c0,c1,a0,a1"];
    C2["c1,c0,a0,a1"] -= temp["c0,c1,a0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccaa"});
    temp["c0,c1,a0,a1"] += -1.0 * H2["v0,c0,c2,a0"] * T2["c1,c2,v0,a1"];
    temp["c0,c1,a0,a1"] += -1.0 * H2["c0,a2,c2,a0"] * T2["c1,c2,a1,a2"];
    temp["c0,c1,a0,a1"] += 1.0 * H2["v0,c0,a0,a2"] * T2["c1,a3,v0,a1"] * L1_["a2,a3"];
    temp["c0,c1,a0,a1"] += 1.0 * H2["c0,a2,c2,a0"] * T2["c1,c2,a1,a3"] * L1_["a3,a2"];
    temp["c0,c1,a0,a1"] += 1.0 * H2["c0,a3,a0,a2"] * T2["c1,a4,a1,a3"] * L1_["a2,a4"];
    temp["c0,c1,a0,a1"] += -1.0 * H2["c0,a3,a0,a2"] * T2["c1,a2,a1,a4"] * L1_["a4,a3"];
    C2["c0,c1,a0,a1"] += temp["c0,c1,a0,a1"];
    C2["c0,c1,a1,a0"] -= temp["c0,c1,a0,a1"];
    C2["c1,c0,a0,a1"] -= temp["c0,c1,a0,a1"];
    C2["c1,c0,a1,a0"] += temp["c0,c1,a0,a1"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vaaa"});
    temp["v0,a0,a1,a2"] += -1.0 * H2["v0,v1,c0,a1"] * T2["c0,a0,v1,a2"];
    temp["v0,a0,a1,a2"] += 1.0 * H2["v0,a0,c0,a1"] * T1["c0,a2"];
    temp["v0,a0,a1,a2"] += 1.0 * H2["v0,a3,c0,a1"] * T2["c0,a0,a2,a3"];
    temp["v0,a0,a1,a2"] += -1.0 * H2["v0,v1,a1,a3"] * T2["a0,a4,v1,a2"] * L1_["a3,a4"];
    temp["v0,a0,a1,a2"] += -1.0 * H2["v0,a3,c0,a1"] * T2["c0,a0,a2,a4"] * L1_["a4,a3"];
    C2["v0,a0,a1,a2"] += temp["v0,a0,a1,a2"];
    C2["v0,a0,a2,a1"] -= temp["v0,a0,a1,a2"];
    C2["a0,v0,a1,a2"] -= temp["v0,a0,a1,a2"];
    C2["a0,v0,a2,a1"] += temp["v0,a0,a1,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vaaa"});
    temp["v0,a0,a1,a2"] += -1.0 * H1["v0,c0"] * T2["c0,a0,a1,a2"];
    temp["v0,a0,a1,a2"] += 1.0 * H2["v0,v1,a1,a2"] * T1["a0,v1"];
    temp["v0,a0,a1,a2"] += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,a1,a2"];
    temp["v0,a0,a1,a2"] += 1.0 * H2["v0,a0,c0,a3"] * T2["c0,a4,a1,a2"] * L1_["a3,a4"];
    C2["v0,a0,a1,a2"] += temp["v0,a0,a1,a2"];
    C2["a0,v0,a1,a2"] -= temp["v0,a0,a1,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"caaa"});
    temp["c0,a0,a1,a2"] += -1.0 * H1["c0,c1"] * T2["c1,a0,a1,a2"];
    temp["c0,a0,a1,a2"] += -1.0 * H1["a0,c1"] * T2["c0,c1,a1,a2"];
    temp["c0,a0,a1,a2"] += -1.0 * H1["a0,a3"] * T2["c0,a3,a1,a2"];
    temp["c0,a0,a1,a2"] += (1.0 / 2.0) * H2["v0,v1,a1,a2"] * T2["c0,a0,v0,v1"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["v0,c0,a1,a2"] * T1["a0,v0"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["v0,a3,a1,a2"] * T2["c0,a0,v0,a3"];
    temp["c0,a0,a1,a2"] += (1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c1,c2,a1,a2"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["a0,a3,a1,a2"] * T1["c0,a3"];
    temp["c0,a0,a1,a2"] += (1.0 / 2.0) * H2["a3,a4,a1,a2"] * T2["c0,a0,a3,a4"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["v0,a3,a1,a2"] * T2["c0,a0,v0,a4"] * L1_["a4,a3"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["c0,a0,c1,a3"] * T2["c1,a4,a1,a2"] * L1_["a3,a4"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["a3,a4,a1,a2"] * T2["c0,a0,a3,a5"] * L1_["a5,a4"];
    C2["c0,a0,a1,a2"] += temp["c0,a0,a1,a2"];
    C2["a0,c0,a1,a2"] -= temp["c0,a0,a1,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"caaa"});
    temp["c0,a0,a1,a2"] += 1.0 * H1["v0,a1"] * T2["c0,a0,v0,a2"];
    temp["c0,a0,a1,a2"] += -1.0 * H1["a3,a1"] * T2["c0,a0,a2,a3"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["v0,c0,c1,a1"] * T2["c1,a0,v0,a2"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["v0,a0,c1,a1"] * T2["c0,c1,v0,a2"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["c0,a0,c1,a1"] * T1["c1,a2"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["c0,a3,c1,a1"] * T2["c1,a0,a2,a3"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["a0,a3,c1,a1"] * T2["c0,c1,a2,a3"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["v0,c0,a1,a3"] * T2["a0,a4,v0,a2"] * L1_["a3,a4"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["v0,a0,a1,a3"] * T2["c0,a4,v0,a2"] * L1_["a3,a4"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["c0,a3,c1,a1"] * T2["c1,a0,a2,a4"] * L1_["a4,a3"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["a0,a3,c1,a1"] * T2["c0,c1,a2,a4"] * L1_["a4,a3"];
    temp["c0,a0,a1,a2"] += -1.0 * H2["a0,a4,a1,a3"] * T2["c0,a5,a2,a4"] * L1_["a3,a5"];
    temp["c0,a0,a1,a2"] += 1.0 * H2["a0,a4,a1,a3"] * T2["c0,a3,a2,a5"] * L1_["a5,a4"];
    C2["c0,a0,a1,a2"] += temp["c0,a0,a1,a2"];
    C2["c0,a0,a2,a1"] -= temp["c0,a0,a1,a2"];
    C2["a0,c0,a1,a2"] -= temp["c0,a0,a1,a2"];
    C2["a0,c0,a2,a1"] += temp["c0,a0,a1,a2"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aaaa"});
    temp["a0,a1,a2,a3"] += 1.0 * H2["v0,a0,c0,a2"] * T2["c0,a1,v0,a3"];
    temp["a0,a1,a2,a3"] += 1.0 * H2["a0,a4,c0,a2"] * T2["c0,a1,a3,a4"];
    temp["a0,a1,a2,a3"] += 1.0 * H2["v0,a0,a2,a4"] * T2["a1,a5,v0,a3"] * L1_["a4,a5"];
    temp["a0,a1,a2,a3"] += -1.0 * H2["a0,a4,c0,a2"] * T2["c0,a1,a3,a5"] * L1_["a5,a4"];
    C2["a0,a1,a2,a3"] += temp["a0,a1,a2,a3"];
    C2["a0,a1,a3,a2"] -= temp["a0,a1,a2,a3"];
    C2["a1,a0,a2,a3"] -= temp["a0,a1,a2,a3"];
    C2["a1,a0,a3,a2"] += temp["a0,a1,a2,a3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aaaa"});
    temp["a0,a1,a2,a3"] += 1.0 * H1["v0,a2"] * T2["a0,a1,v0,a3"];
    temp["a0,a1,a2,a3"] += 1.0 * H2["a0,a1,c0,a2"] * T1["c0,a3"];
    C2["a0,a1,a2,a3"] += temp["a0,a1,a2,a3"];
    C2["a0,a1,a3,a2"] -= temp["a0,a1,a2,a3"];

    temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aaaa"});
    temp["a0,a1,a2,a3"] += -1.0 * H1["a0,c0"] * T2["c0,a1,a2,a3"];
    temp["a0,a1,a2,a3"] += -1.0 * H2["v0,a0,a2,a3"] * T1["a1,v0"];
    C2["a0,a1,a2,a3"] += temp["a0,a1,a2,a3"];
    C2["a1,a0,a2,a3"] -= temp["a0,a1,a2,a3"];

    C2["a0,a1,a2,a3"] += (1.0 / 2.0) * H2["v0,v1,a2,a3"] * T2["a0,a1,v0,v1"];
    C2["a0,a1,a2,a3"] += 1.0 * H2["v0,a4,a2,a3"] * T2["a0,a1,v0,a4"];
    C2["a0,a1,a2,a3"] += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,a2,a3"];
    C2["a0,a1,a2,a3"] += -1.0 * H2["v0,a4,a2,a3"] * T2["a0,a1,v0,a5"] * L1_["a5,a4"];
    C2["a0,a1,a2,a3"] += 1.0 * H2["a0,a1,c0,a4"] * T2["c0,a5,a2,a3"] * L1_["a4,a5"];

    C0 *= factor;
    C1.scale(factor);
    C2.scale(factor);
}

void TROTTER_SO::ccsd_hamiltonian(int level, BlockedTensor& H1, BlockedTensor& H2,
                                  BlockedTensor& T1, BlockedTensor& T2, double& C0,
                                  BlockedTensor& C1, BlockedTensor& C2) {
    BlockedTensor temp;
    if (level == 1) {
        C0 += 1.0 * H1["v0,c0"] * T1["c0,v0"];
        C0 += (1.0 / 4.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,v0,v1"];

        C1["c0,v0"] += 1.0 * H1["v1,v0"] * T1["c0,v1"];
        C1["c0,v0"] += 1.0 * H1["v1,c1"] * T2["c0,c1,v0,v1"];
        C1["c0,v0"] += -1.0 * H1["c0,c1"] * T1["c1,v0"];
        C1["c0,v0"] += (1.0 / 2.0) * H2["v1,v2,v0,c1"] * T2["c0,c1,v1,v2"];
        C1["c0,v0"] += -1.0 * H2["v1,c0,v0,c1"] * T1["c1,v1"];
        C1["c0,v0"] += (1.0 / 2.0) * H2["v1,c0,c1,c2"] * T2["c1,c2,v0,v1"];

        C1["a0,v0"] += -1.0 * H1["a0,c0"] * T1["c0,v0"];
        C1["a0,v0"] += -1.0 * H2["v1,a0,v0,c0"] * T1["c0,v1"];
        C1["a0,v0"] += (1.0 / 2.0) * H2["v1,a0,c0,c1"] * T2["c0,c1,v0,v1"];

        C1["v0,v1"] += -1.0 * H1["v0,c0"] * T1["c0,v1"];
        C1["v0,v1"] += 1.0 * H2["v0,v2,v1,c0"] * T1["c0,v2"];
        C1["v0,v1"] += (-1.0 / 2.0) * H2["v0,v2,c0,c1"] * T2["c0,c1,v1,v2"];

        C1["v0,c0"] += 1.0 * H2["v0,v1,c0,c1"] * T1["c1,v1"];

        C1["a0,c0"] += -1.0 * H2["v0,a0,c0,c1"] * T1["c1,v0"];

        C1["c0,c1"] += 1.0 * H1["v0,c1"] * T1["c0,v0"];
        C1["c0,c1"] += (1.0 / 2.0) * H2["v0,v1,c1,c2"] * T2["c0,c2,v0,v1"];
        C1["c0,c1"] += -1.0 * H2["v0,c0,c1,c2"] * T1["c2,v0"];

        C1["v0,a0"] += -1.0 * H2["v0,v1,c0,a0"] * T1["c0,v1"];

        C1["c0,a0"] += 1.0 * H1["v0,a0"] * T1["c0,v0"];
        C1["c0,a0"] += (-1.0 / 2.0) * H2["v0,v1,c1,a0"] * T2["c0,c1,v0,v1"];
        C1["c0,a0"] += 1.0 * H2["v0,c0,c1,a0"] * T1["c1,v0"];

        C1["a0,a1"] += 1.0 * H2["v0,a0,c0,a1"] * T1["c0,v0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += -1.0 * H2["v2,c0,v0,c2"] * T2["c1,c2,v1,v2"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v1,v0"] += temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += -1.0 * H1["v2,v0"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,v1"] += -1.0 * H2["c0,c1,v0,c2"] * T1["c2,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += 1.0 * H1["c0,c2"] * T2["c1,c2,v0,v1"];
        temp["c0,c1,v0,v1"] += -1.0 * H2["v2,c0,v0,v1"] * T1["c1,v2"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];

        C2["c0,c1,v0,v1"] += (1.0 / 2.0) * H2["v2,v3,v0,v1"] * T2["c0,c1,v2,v3"];
        C2["c0,c1,v0,v1"] += (1.0 / 2.0) * H2["c0,c1,c2,c3"] * T2["c2,c3,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
        temp["c0,a0,v0,v1"] += 1.0 * H2["v2,a0,v0,c1"] * T2["c0,c1,v1,v2"];
        temp["c0,a0,v0,v1"] += -1.0 * H2["c0,a0,v0,c1"] * T1["c1,v1"];
        C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
        C2["c0,a0,v1,v0"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v1,v0"] += temp["c0,a0,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
        temp["c0,a0,v0,v1"] += -1.0 * H1["a0,c1"] * T2["c0,c1,v0,v1"];
        temp["c0,a0,v0,v1"] += 1.0 * H2["v2,a0,v0,v1"] * T1["c0,v2"];
        temp["c0,a0,v0,v1"] += (1.0 / 2.0) * H2["c0,a0,c1,c2"] * T2["c1,c2,v0,v1"];
        C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
        C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];

        C2["a0,a1,v0,v1"] += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavv"});
        temp["a0,a1,v0,v1"] += -1.0 * H2["a0,a1,v0,c0"] * T1["c0,v1"];
        C2["a0,a1,v0,v1"] += temp["a0,a1,v0,v1"];
        C2["a0,a1,v1,v0"] -= temp["a0,a1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavc"});
        temp["a0,a1,v0,c0"] += 1.0 * H2["a0,a1,c0,c1"] * T1["c1,v0"];
        C2["a0,a1,v0,c0"] += temp["a0,a1,v0,c0"];
        C2["a0,a1,c0,v0"] -= temp["a0,a1,v0,c0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavc"});
        temp["c0,a0,v0,c1"] += 1.0 * H2["v1,a0,v0,c1"] * T1["c0,v1"];
        temp["c0,a0,v0,c1"] += -1.0 * H2["v1,a0,c1,c2"] * T2["c0,c2,v0,v1"];
        temp["c0,a0,v0,c1"] += 1.0 * H2["c0,a0,c1,c2"] * T1["c2,v0"];
        C2["c0,a0,v0,c1"] += temp["c0,a0,v0,c1"];
        C2["c0,a0,c1,v0"] -= temp["c0,a0,v0,c1"];
        C2["a0,c0,v0,c1"] -= temp["c0,a0,v0,c1"];
        C2["a0,c0,c1,v0"] += temp["c0,a0,v0,c1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
        temp["c0,c1,v0,c2"] += -1.0 * H2["v1,c0,v0,c2"] * T1["c1,v1"];
        temp["c0,c1,v0,c2"] += 1.0 * H2["v1,c0,c2,c3"] * T2["c1,c3,v0,v1"];
        C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
        C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,v0,c2"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,c2,v0"] += temp["c0,c1,v0,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
        temp["c0,c1,v0,c2"] += 1.0 * H1["v1,c2"] * T2["c0,c1,v0,v1"];
        temp["c0,c1,v0,c2"] += (1.0 / 2.0) * H2["v1,v2,v0,c2"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,c2"] += 1.0 * H2["c0,c1,c2,c3"] * T1["c3,v0"];
        C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
        C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
        temp["c0,c1,v0,a0"] += -1.0 * H2["v1,c0,v0,a0"] * T1["c1,v1"];
        temp["c0,c1,v0,a0"] += -1.0 * H2["v1,c0,c2,a0"] * T2["c1,c2,v0,v1"];
        C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
        C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,v0,a0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,a0,v0"] += temp["c0,c1,v0,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
        temp["c0,c1,v0,a0"] += 1.0 * H1["v1,a0"] * T2["c0,c1,v0,v1"];
        temp["c0,c1,v0,a0"] += (1.0 / 2.0) * H2["v1,v2,v0,a0"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,a0"] += -1.0 * H2["c0,c1,c2,a0"] * T1["c2,v0"];
        C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
        C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cava"});
        temp["c0,a0,v0,a1"] += 1.0 * H2["v1,a0,v0,a1"] * T1["c0,v1"];
        temp["c0,a0,v0,a1"] += 1.0 * H2["v1,a0,c1,a1"] * T2["c0,c1,v0,v1"];
        temp["c0,a0,v0,a1"] += -1.0 * H2["c0,a0,c1,a1"] * T1["c1,v0"];
        C2["c0,a0,v0,a1"] += temp["c0,a0,v0,a1"];
        C2["c0,a0,a1,v0"] -= temp["c0,a0,v0,a1"];
        C2["a0,c0,v0,a1"] -= temp["c0,a0,v0,a1"];
        C2["a0,c0,a1,v0"] += temp["c0,a0,v0,a1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aava"});
        temp["a0,a1,v0,a2"] += -1.0 * H2["a0,a1,c0,a2"] * T1["c0,v0"];
        C2["a0,a1,v0,a2"] += temp["a0,a1,v0,a2"];
        C2["a0,a1,a2,v0"] -= temp["a0,a1,v0,a2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
        temp["v0,c0,v1,v2"] += 1.0 * H2["v0,v3,v1,c1"] * T2["c0,c1,v2,v3"];
        temp["v0,c0,v1,v2"] += -1.0 * H2["v0,c0,v1,c1"] * T1["c1,v2"];
        C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
        C2["v0,c0,v2,v1"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v2,v1"] += temp["v0,c0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
        temp["v0,c0,v1,v2"] += 1.0 * H1["v0,c1"] * T2["c0,c1,v1,v2"];
        temp["v0,c0,v1,v2"] += 1.0 * H2["v0,v3,v1,v2"] * T1["c0,v3"];
        temp["v0,c0,v1,v2"] += (1.0 / 2.0) * H2["v0,c0,c1,c2"] * T2["c1,c2,v1,v2"];
        C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
        C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavv"});
        temp["v0,a0,v1,v2"] += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,v1,v2"];
        C2["v0,a0,v1,v2"] += temp["v0,a0,v1,v2"];
        C2["a0,v0,v1,v2"] -= temp["v0,a0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavv"});
        temp["v0,a0,v1,v2"] += -1.0 * H2["v0,a0,v1,c0"] * T1["c0,v2"];
        C2["v0,a0,v1,v2"] += temp["v0,a0,v1,v2"];
        C2["v0,a0,v2,v1"] -= temp["v0,a0,v1,v2"];
        C2["a0,v0,v1,v2"] -= temp["v0,a0,v1,v2"];
        C2["a0,v0,v2,v1"] += temp["v0,a0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavc"});
        temp["v0,a0,v1,c0"] += 1.0 * H2["v0,a0,c0,c1"] * T1["c1,v1"];
        C2["v0,a0,v1,c0"] += temp["v0,a0,v1,c0"];
        C2["v0,a0,c0,v1"] -= temp["v0,a0,v1,c0"];
        C2["a0,v0,v1,c0"] -= temp["v0,a0,v1,c0"];
        C2["a0,v0,c0,v1"] += temp["v0,a0,v1,c0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvc"});
        temp["v0,c0,v1,c1"] += 1.0 * H2["v0,v2,v1,c1"] * T1["c0,v2"];
        temp["v0,c0,v1,c1"] += -1.0 * H2["v0,v2,c1,c2"] * T2["c0,c2,v1,v2"];
        temp["v0,c0,v1,c1"] += 1.0 * H2["v0,c0,c1,c2"] * T1["c2,v1"];
        C2["v0,c0,v1,c1"] += temp["v0,c0,v1,c1"];
        C2["v0,c0,c1,v1"] -= temp["v0,c0,v1,c1"];
        C2["c0,v0,v1,c1"] -= temp["v0,c0,v1,c1"];
        C2["c0,v0,c1,v1"] += temp["v0,c0,v1,c1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcva"});
        temp["v0,c0,v1,a0"] += 1.0 * H2["v0,v2,v1,a0"] * T1["c0,v2"];
        temp["v0,c0,v1,a0"] += 1.0 * H2["v0,v2,c1,a0"] * T2["c0,c1,v1,v2"];
        temp["v0,c0,v1,a0"] += -1.0 * H2["v0,c0,c1,a0"] * T1["c1,v1"];
        C2["v0,c0,v1,a0"] += temp["v0,c0,v1,a0"];
        C2["v0,c0,a0,v1"] -= temp["v0,c0,v1,a0"];
        C2["c0,v0,v1,a0"] -= temp["v0,c0,v1,a0"];
        C2["c0,v0,a0,v1"] += temp["v0,c0,v1,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vava"});
        temp["v0,a0,v1,a1"] += -1.0 * H2["v0,a0,c0,a1"] * T1["c0,v1"];
        C2["v0,a0,v1,a1"] += temp["v0,a0,v1,a1"];
        C2["v0,a0,a1,v1"] -= temp["v0,a0,v1,a1"];
        C2["a0,v0,v1,a1"] -= temp["v0,a0,v1,a1"];
        C2["a0,v0,a1,v1"] += temp["v0,a0,v1,a1"];

        C2["v0,v1,v2,v3"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,v2,v3"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvvv"});
        temp["v0,v1,v2,v3"] += -1.0 * H2["v0,v1,v2,c0"] * T1["c0,v3"];
        C2["v0,v1,v2,v3"] += temp["v0,v1,v2,v3"];
        C2["v0,v1,v3,v2"] -= temp["v0,v1,v2,v3"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvvc"});
        temp["v0,v1,v2,c0"] += 1.0 * H2["v0,v1,c0,c1"] * T1["c1,v2"];
        C2["v0,v1,v2,c0"] += temp["v0,v1,v2,c0"];
        C2["v0,v1,c0,v2"] -= temp["v0,v1,v2,c0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvva"});
        temp["v0,v1,v2,a0"] += -1.0 * H2["v0,v1,c0,a0"] * T1["c0,v2"];
        C2["v0,v1,v2,a0"] += temp["v0,v1,v2,a0"];
        C2["v0,v1,a0,v2"] -= temp["v0,v1,v2,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vccc"});
        temp["v0,c0,c1,c2"] += 1.0 * H2["v0,v1,c1,c2"] * T1["c0,v1"];
        C2["v0,c0,c1,c2"] += temp["v0,c0,c1,c2"];
        C2["c0,v0,c1,c2"] -= temp["v0,c0,c1,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cacc"});
        temp["c0,a0,c1,c2"] += 1.0 * H2["v0,a0,c1,c2"] * T1["c0,v0"];
        C2["c0,a0,c1,c2"] += temp["c0,a0,c1,c2"];
        C2["a0,c0,c1,c2"] -= temp["c0,a0,c1,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcca"});
        temp["v0,c0,c1,a0"] += 1.0 * H2["v0,v1,c1,a0"] * T1["c0,v1"];
        C2["v0,c0,c1,a0"] += temp["v0,c0,c1,a0"];
        C2["v0,c0,a0,c1"] -= temp["v0,c0,c1,a0"];
        C2["c0,v0,c1,a0"] -= temp["v0,c0,c1,a0"];
        C2["c0,v0,a0,c1"] += temp["v0,c0,c1,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"caca"});
        temp["c0,a0,c1,a1"] += 1.0 * H2["v0,a0,c1,a1"] * T1["c0,v0"];
        C2["c0,a0,c1,a1"] += temp["c0,a0,c1,a1"];
        C2["c0,a0,a1,c1"] -= temp["c0,a0,c1,a1"];
        C2["a0,c0,c1,a1"] -= temp["c0,a0,c1,a1"];
        C2["a0,c0,a1,c1"] += temp["c0,a0,c1,a1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cccc"});
        temp["c0,c1,c2,c3"] += -1.0 * H2["v0,c0,c2,c3"] * T1["c1,v0"];
        C2["c0,c1,c2,c3"] += temp["c0,c1,c2,c3"];
        C2["c1,c0,c2,c3"] -= temp["c0,c1,c2,c3"];

        C2["c0,c1,c2,c3"] += (1.0 / 2.0) * H2["v0,v1,c2,c3"] * T2["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccca"});
        temp["c0,c1,c2,a0"] += -1.0 * H2["v0,c0,c2,a0"] * T1["c1,v0"];
        C2["c0,c1,c2,a0"] += temp["c0,c1,c2,a0"];
        C2["c0,c1,a0,c2"] -= temp["c0,c1,c2,a0"];
        C2["c1,c0,c2,a0"] -= temp["c0,c1,c2,a0"];
        C2["c1,c0,a0,c2"] += temp["c0,c1,c2,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccca"});
        temp["c0,c1,c2,a0"] += (1.0 / 2.0) * H2["v0,v1,c2,a0"] * T2["c0,c1,v0,v1"];
        C2["c0,c1,c2,a0"] += temp["c0,c1,c2,a0"];
        C2["c0,c1,a0,c2"] -= temp["c0,c1,c2,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcaa"});
        temp["v0,c0,a0,a1"] += 1.0 * H2["v0,v1,a0,a1"] * T1["c0,v1"];
        C2["v0,c0,a0,a1"] += temp["v0,c0,a0,a1"];
        C2["c0,v0,a0,a1"] -= temp["v0,c0,a0,a1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccaa"});
        temp["c0,c1,a0,a1"] += -1.0 * H2["v0,c0,a0,a1"] * T1["c1,v0"];
        C2["c0,c1,a0,a1"] += temp["c0,c1,a0,a1"];
        C2["c1,c0,a0,a1"] -= temp["c0,c1,a0,a1"];

        C2["c0,c1,a0,a1"] += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"caaa"});
        temp["c0,a0,a1,a2"] += 1.0 * H2["v0,a0,a1,a2"] * T1["c0,v0"];
        C2["c0,a0,a1,a2"] += temp["c0,a0,a1,a2"];
        C2["a0,c0,a1,a2"] -= temp["c0,a0,a1,a2"];
    } else if (level == 2) {
        C0 += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T1["c0,v0"] * T1["c1,v1"];

        C1["c0,v0"] += -1.0 * H1["v1,c1"] * T1["c0,v1"] * T1["c1,v0"];
        C1["c0,v0"] += 1.0 * H2["v1,v2,v0,c1"] * T1["c0,v1"] * T1["c1,v2"];
        C1["c0,v0"] += (-1.0 / 2.0) * H2["v1,v2,c1,c2"] * T1["c0,v1"] * T2["c1,c2,v0,v2"];
        C1["c0,v0"] += (-1.0 / 2.0) * H2["v1,v2,c1,c2"] * T1["c1,v0"] * T2["c0,c2,v1,v2"];
        C1["c0,v0"] += 1.0 * H2["v1,v2,c1,c2"] * T1["c1,v1"] * T2["c0,c2,v0,v2"];
        C1["c0,v0"] += 1.0 * H2["v1,c0,c1,c2"] * T1["c1,v0"] * T1["c2,v1"];

        C1["a0,v0"] += 1.0 * H2["v1,a0,c0,c1"] * T1["c0,v0"] * T1["c1,v1"];

        C1["v0,v1"] += -1.0 * H2["v0,v2,c0,c1"] * T1["c0,v1"] * T1["c1,v2"];

        C1["c0,c1"] += 1.0 * H2["v0,v1,c1,c2"] * T1["c0,v0"] * T1["c2,v1"];

        C1["c0,a0"] += -1.0 * H2["v0,v1,c1,a0"] * T1["c0,v0"] * T1["c1,v1"];

        C2["c0,c1,v0,v1"] +=
            (1.0 / 4.0) * H2["v2,v3,c2,c3"] * T2["c0,c1,v2,v3"] * T2["c2,c3,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += 1.0 * H1["v2,c2"] * T1["c0,v2"] * T2["c1,c2,v0,v1"];
        temp["c0,c1,v0,v1"] += (1.0 / 2.0) * H2["v2,v3,v0,v1"] * T1["c0,v2"] * T1["c1,v3"];
        temp["c0,c1,v0,v1"] +=
            (-1.0 / 2.0) * H2["v2,v3,c2,c3"] * T2["c0,c2,v0,v1"] * T2["c1,c3,v2,v3"];
        temp["c0,c1,v0,v1"] += (-1.0 / 2.0) * H2["v2,c0,c2,c3"] * T1["c1,v2"] * T2["c2,c3,v0,v1"];
        temp["c0,c1,v0,v1"] += 1.0 * H2["v2,c0,c2,c3"] * T1["c2,v2"] * T2["c1,c3,v0,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += 1.0 * H1["v2,c2"] * T1["c2,v0"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,v1"] += (-1.0 / 2.0) * H2["v2,v3,v0,c2"] * T1["c2,v1"] * T2["c0,c1,v2,v3"];
        temp["c0,c1,v0,v1"] += 1.0 * H2["v2,v3,v0,c2"] * T1["c2,v2"] * T2["c0,c1,v1,v3"];
        temp["c0,c1,v0,v1"] +=
            (-1.0 / 2.0) * H2["v2,v3,c2,c3"] * T2["c0,c1,v0,v2"] * T2["c2,c3,v1,v3"];
        temp["c0,c1,v0,v1"] += (1.0 / 2.0) * H2["c0,c1,c2,c3"] * T1["c2,v0"] * T1["c3,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] += 1.0 * H2["v2,v3,v0,c2"] * T1["c0,v2"] * T2["c1,c2,v1,v3"];
        temp["c0,c1,v0,v1"] +=
            (1.0 / 2.0) * H2["v2,v3,c2,c3"] * T2["c0,c2,v0,v2"] * T2["c1,c3,v1,v3"];
        temp["c0,c1,v0,v1"] += 1.0 * H2["v2,c0,v0,c2"] * T1["c1,v2"] * T1["c2,v1"];
        temp["c0,c1,v0,v1"] += 1.0 * H2["v2,c0,c2,c3"] * T1["c2,v0"] * T2["c1,c3,v1,v2"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v1,v0"] += temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
        temp["c0,a0,v0,v1"] += (1.0 / 2.0) * H2["v2,a0,c1,c2"] * T1["c0,v2"] * T2["c1,c2,v0,v1"];
        temp["c0,a0,v0,v1"] += -1.0 * H2["v2,a0,c1,c2"] * T1["c1,v2"] * T2["c0,c2,v0,v1"];
        C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
        C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
        temp["c0,a0,v0,v1"] += -1.0 * H2["v2,a0,v0,c1"] * T1["c0,v2"] * T1["c1,v1"];
        temp["c0,a0,v0,v1"] += -1.0 * H2["v2,a0,c1,c2"] * T1["c1,v0"] * T2["c0,c2,v1,v2"];
        temp["c0,a0,v0,v1"] += (1.0 / 2.0) * H2["c0,a0,c1,c2"] * T1["c1,v0"] * T1["c2,v1"];
        C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
        C2["c0,a0,v1,v0"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v1,v0"] += temp["c0,a0,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"aavv"});
        temp["a0,a1,v0,v1"] += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T1["c0,v0"] * T1["c1,v1"];
        C2["a0,a1,v0,v1"] += temp["a0,a1,v0,v1"];
        C2["a0,a1,v1,v0"] -= temp["a0,a1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavc"});
        temp["c0,a0,v0,c1"] += 1.0 * H2["v1,a0,c1,c2"] * T1["c0,v1"] * T1["c2,v0"];
        C2["c0,a0,v0,c1"] += temp["c0,a0,v0,c1"];
        C2["c0,a0,c1,v0"] -= temp["c0,a0,v0,c1"];
        C2["a0,c0,v0,c1"] -= temp["c0,a0,v0,c1"];
        C2["a0,c0,c1,v0"] += temp["c0,a0,v0,c1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
        temp["c0,c1,v0,c2"] += (1.0 / 2.0) * H2["v1,v2,c2,c3"] * T1["c3,v0"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,c2"] += -1.0 * H2["v1,v2,c2,c3"] * T1["c3,v1"] * T2["c0,c1,v0,v2"];
        C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
        C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
        temp["c0,c1,v0,c2"] += (1.0 / 2.0) * H2["v1,v2,v0,c2"] * T1["c0,v1"] * T1["c1,v2"];
        temp["c0,c1,v0,c2"] += -1.0 * H2["v1,v2,c2,c3"] * T1["c0,v1"] * T2["c1,c3,v0,v2"];
        temp["c0,c1,v0,c2"] += -1.0 * H2["v1,c0,c2,c3"] * T1["c1,v1"] * T1["c3,v0"];
        C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
        C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,v0,c2"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,c2,v0"] += temp["c0,c1,v0,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
        temp["c0,c1,v0,a0"] += (-1.0 / 2.0) * H2["v1,v2,c2,a0"] * T1["c2,v0"] * T2["c0,c1,v1,v2"];
        temp["c0,c1,v0,a0"] += 1.0 * H2["v1,v2,c2,a0"] * T1["c2,v1"] * T2["c0,c1,v0,v2"];
        C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
        C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
        temp["c0,c1,v0,a0"] += (1.0 / 2.0) * H2["v1,v2,v0,a0"] * T1["c0,v1"] * T1["c1,v2"];
        temp["c0,c1,v0,a0"] += 1.0 * H2["v1,v2,c2,a0"] * T1["c0,v1"] * T2["c1,c2,v0,v2"];
        temp["c0,c1,v0,a0"] += 1.0 * H2["v1,c0,c2,a0"] * T1["c1,v1"] * T1["c2,v0"];
        C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
        C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,v0,a0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,a0,v0"] += temp["c0,c1,v0,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cava"});
        temp["c0,a0,v0,a1"] += -1.0 * H2["v1,a0,c1,a1"] * T1["c0,v1"] * T1["c1,v0"];
        C2["c0,a0,v0,a1"] += temp["c0,a0,v0,a1"];
        C2["c0,a0,a1,v0"] -= temp["c0,a0,v0,a1"];
        C2["a0,c0,v0,a1"] -= temp["c0,a0,v0,a1"];
        C2["a0,c0,a1,v0"] += temp["c0,a0,v0,a1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
        temp["v0,c0,v1,v2"] += (1.0 / 2.0) * H2["v0,v3,c1,c2"] * T1["c0,v3"] * T2["c1,c2,v1,v2"];
        temp["v0,c0,v1,v2"] += -1.0 * H2["v0,v3,c1,c2"] * T1["c1,v3"] * T2["c0,c2,v1,v2"];
        C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
        C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
        temp["v0,c0,v1,v2"] += -1.0 * H2["v0,v3,v1,c1"] * T1["c0,v3"] * T1["c1,v2"];
        temp["v0,c0,v1,v2"] += -1.0 * H2["v0,v3,c1,c2"] * T1["c1,v1"] * T2["c0,c2,v2,v3"];
        temp["v0,c0,v1,v2"] += (1.0 / 2.0) * H2["v0,c0,c1,c2"] * T1["c1,v1"] * T1["c2,v2"];
        C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
        C2["v0,c0,v2,v1"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v2,v1"] += temp["v0,c0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vavv"});
        temp["v0,a0,v1,v2"] += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T1["c0,v1"] * T1["c1,v2"];
        C2["v0,a0,v1,v2"] += temp["v0,a0,v1,v2"];
        C2["v0,a0,v2,v1"] -= temp["v0,a0,v1,v2"];
        C2["a0,v0,v1,v2"] -= temp["v0,a0,v1,v2"];
        C2["a0,v0,v2,v1"] += temp["v0,a0,v1,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvc"});
        temp["v0,c0,v1,c1"] += 1.0 * H2["v0,v2,c1,c2"] * T1["c0,v2"] * T1["c2,v1"];
        C2["v0,c0,v1,c1"] += temp["v0,c0,v1,c1"];
        C2["v0,c0,c1,v1"] -= temp["v0,c0,v1,c1"];
        C2["c0,v0,v1,c1"] -= temp["v0,c0,v1,c1"];
        C2["c0,v0,c1,v1"] += temp["v0,c0,v1,c1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcva"});
        temp["v0,c0,v1,a0"] += -1.0 * H2["v0,v2,c1,a0"] * T1["c0,v2"] * T1["c1,v1"];
        C2["v0,c0,v1,a0"] += temp["v0,c0,v1,a0"];
        C2["v0,c0,a0,v1"] -= temp["v0,c0,v1,a0"];
        C2["c0,v0,v1,a0"] -= temp["v0,c0,v1,a0"];
        C2["c0,v0,a0,v1"] += temp["v0,c0,v1,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vvvv"});
        temp["v0,v1,v2,v3"] += (1.0 / 2.0) * H2["v0,v1,c0,c1"] * T1["c0,v2"] * T1["c1,v3"];
        C2["v0,v1,v2,v3"] += temp["v0,v1,v2,v3"];
        C2["v0,v1,v3,v2"] -= temp["v0,v1,v2,v3"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cccc"});
        temp["c0,c1,c2,c3"] += (1.0 / 2.0) * H2["v0,v1,c2,c3"] * T1["c0,v0"] * T1["c1,v1"];
        C2["c0,c1,c2,c3"] += temp["c0,c1,c2,c3"];
        C2["c1,c0,c2,c3"] -= temp["c0,c1,c2,c3"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccca"});
        temp["c0,c1,c2,a0"] += (1.0 / 2.0) * H2["v0,v1,c2,a0"] * T1["c0,v0"] * T1["c1,v1"];
        C2["c0,c1,c2,a0"] += temp["c0,c1,c2,a0"];
        C2["c0,c1,a0,c2"] -= temp["c0,c1,c2,a0"];
        C2["c1,c0,c2,a0"] -= temp["c0,c1,c2,a0"];
        C2["c1,c0,a0,c2"] += temp["c0,c1,c2,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccaa"});
        temp["c0,c1,a0,a1"] += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T1["c0,v0"] * T1["c1,v1"];
        C2["c0,c1,a0,a1"] += temp["c0,c1,a0,a1"];
        C2["c1,c0,a0,a1"] -= temp["c0,c1,a0,a1"];
    } else if (level == 3) {
        C1["c0,v0"] += -1.0 * H2["v1,v2,c1,c2"] * T1["c0,v1"] * T1["c1,v0"] * T1["c2,v2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] +=
            (1.0 / 4.0) * H2["v2,v3,c2,c3"] * T1["c2,v0"] * T1["c3,v1"] * T2["c0,c1,v2,v3"];
        temp["c0,c1,v0,v1"] +=
            -1.0 * H2["v2,v3,c2,c3"] * T1["c2,v0"] * T1["c3,v2"] * T2["c0,c1,v1,v3"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] +=
            (-1.0 / 2.0) * H2["v2,v3,v0,c2"] * T1["c0,v2"] * T1["c1,v3"] * T1["c2,v1"];
        temp["c0,c1,v0,v1"] +=
            -1.0 * H2["v2,v3,c2,c3"] * T1["c0,v2"] * T1["c2,v0"] * T2["c1,c3,v1,v3"];
        temp["c0,c1,v0,v1"] +=
            (-1.0 / 2.0) * H2["v2,c0,c2,c3"] * T1["c1,v2"] * T1["c2,v0"] * T1["c3,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v1,v0"] += temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] +=
            (1.0 / 4.0) * H2["v2,v3,c2,c3"] * T1["c0,v2"] * T1["c1,v3"] * T2["c2,c3,v0,v1"];
        temp["c0,c1,v0,v1"] +=
            -1.0 * H2["v2,v3,c2,c3"] * T1["c0,v2"] * T1["c2,v3"] * T2["c1,c3,v0,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"cavv"});
        temp["c0,a0,v0,v1"] +=
            (1.0 / 2.0) * H2["v2,a0,c1,c2"] * T1["c0,v2"] * T1["c1,v0"] * T1["c2,v1"];
        C2["c0,a0,v0,v1"] += temp["c0,a0,v0,v1"];
        C2["c0,a0,v1,v0"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v0,v1"] -= temp["c0,a0,v0,v1"];
        C2["a0,c0,v1,v0"] += temp["c0,a0,v0,v1"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvc"});
        temp["c0,c1,v0,c2"] +=
            (1.0 / 2.0) * H2["v1,v2,c2,c3"] * T1["c0,v1"] * T1["c1,v2"] * T1["c3,v0"];
        C2["c0,c1,v0,c2"] += temp["c0,c1,v0,c2"];
        C2["c0,c1,c2,v0"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,v0,c2"] -= temp["c0,c1,v0,c2"];
        C2["c1,c0,c2,v0"] += temp["c0,c1,v0,c2"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccva"});
        temp["c0,c1,v0,a0"] +=
            (-1.0 / 2.0) * H2["v1,v2,c2,a0"] * T1["c0,v1"] * T1["c1,v2"] * T1["c2,v0"];
        C2["c0,c1,v0,a0"] += temp["c0,c1,v0,a0"];
        C2["c0,c1,a0,v0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,v0,a0"] -= temp["c0,c1,v0,a0"];
        C2["c1,c0,a0,v0"] += temp["c0,c1,v0,a0"];

        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"vcvv"});
        temp["v0,c0,v1,v2"] +=
            (1.0 / 2.0) * H2["v0,v3,c1,c2"] * T1["c0,v3"] * T1["c1,v1"] * T1["c2,v2"];
        C2["v0,c0,v1,v2"] += temp["v0,c0,v1,v2"];
        C2["v0,c0,v2,v1"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v1,v2"] -= temp["v0,c0,v1,v2"];
        C2["c0,v0,v2,v1"] += temp["v0,c0,v1,v2"];
    } else {
        temp = ambit::BlockedTensor::build(ambit::CoreTensor, "temp", {"ccvv"});
        temp["c0,c1,v0,v1"] +=
            (1.0 / 4.0) * H2["v2,v3,c2,c3"] * T1["c0,v2"] * T1["c1,v3"] * T1["c2,v0"] * T1["c3,v1"];
        C2["c0,c1,v0,v1"] += temp["c0,c1,v0,v1"];
        C2["c0,c1,v1,v0"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v0,v1"] -= temp["c0,c1,v0,v1"];
        C2["c1,c0,v1,v0"] += temp["c0,c1,v0,v1"];
    }
}

void TROTTER_SO::comm2_O_Ta_C(int k, BlockedTensor& H2, BlockedTensor& T1,
                              BlockedTensor& T2, double& C0, BlockedTensor& C1, BlockedTensor& C2) {
    C0 = 0.0;
    C1.zero();
    C2.zero();

    C0 += (-1.0 / 4.0) * H2["v0,v1,c0,c1"] * T2["c0,c1,v0,a0"] * T2["a2,a3,v1,a1"] * L2_["a0,a1,a2,a3"];
    C0 += (-1.0 / 4.0) * H2["v0,v1,c0,c1"] * T2["c0,a0,v0,v1"] * T2["c1,a1,a2,a3"] * L2_["a2,a3,a0,a1"];
    C0 += 1.0 * H2["v0,v1,c0,a0"] * T2["c0,a2,v0,a1"] * T2["a1,a4,v1,a3"] * L2_["a0,a3,a2,a4"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["c0,a2,v0,a1"] * T2["a4,a5,v1,a3"] * L3_["a0,a1,a3,a2,a4,a5"];
    C0 += (1.0 / 8.0) * H2["v0,v1,c0,a0"] * T2["a1,a2,v0,v1"] * T2["c0,a3,a4,a5"] * L3_["a0,a4,a5,a1,a2,a3"];
    C0 += (1.0 / 4.0) * H2["v0,v1,a0,a1"] * T1["a2,v0"] * T2["a4,a5,v1,a3"] * L3_["a0,a1,a3,a2,a4,a5"];
    C0 += (-1.0 / 4.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a5,a6,v1,a3"] * L3_["a0,a1,a2,a4,a5,a6"];
    C0 += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,a1,v0,a0"] * T2["c1,a2,a3,a4"] * L2_["a3,a4,a1,a2"];
    C0 += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,a2,v0,a1"] * T2["c1,a1,a3,a4"] * L2_["a3,a4,a0,a2"];
    C0 += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,a2,v0,a1"] * T2["c1,a3,a4,a5"] * L3_["a1,a4,a5,a0,a2,a3"];
    C0 += (-1.0 / 4.0) * H2["v0,a0,c0,c1"] * T2["c0,c1,a0,a4"] * T2["a2,a3,v0,a1"] * L2_["a1,a4,a2,a3"];
    C0 += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["a2,a3,v0,a1"] * T2["c0,c1,a2,a4"] * L2_["a1,a4,a0,a3"];
    C0 += (-1.0 / 8.0) * H2["v0,a0,c0,c1"] * T2["a2,a3,v0,a1"] * T2["c0,c1,a4,a5"] * L3_["a1,a4,a5,a0,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T1["a2,v0"] * T2["c0,a3,a4,a5"] * L3_["a0,a4,a5,a1,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T1["c0,a2"] * T2["a4,a5,v0,a3"] * L3_["a0,a2,a3,a1,a4,a5"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["c0,a5,a1,a3"] * T2["a3,a4,v0,a2"] * L2_["a0,a2,a4,a5"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["c0,a5,a1,a6"] * T2["a3,a4,v0,a2"] * L3_["a0,a2,a6,a3,a4,a5"];
    C0 += (1.0 / 4.0) * H2["v0,a1,c0,a0"] * T2["a2,a3,v0,a1"] * T2["c0,a4,a5,a6"] * L3_["a0,a5,a6,a2,a3,a4"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a4"] * L2_["a0,a2,a1,a5"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a6"] * L3_["a0,a2,a6,a1,a4,a5"];
    C0 += (-1.0 / 4.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a2,a5,a6"] * L3_["a0,a5,a6,a1,a3,a4"];
    C0 += (1.0 / 4.0) * H2["a0,a1,c0,c1"] * T1["c0,a2"] * T2["c1,a3,a4,a5"] * L3_["a2,a4,a5,a0,a1,a3"];
    C0 += (-1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a1"] * T2["c1,a3,a4,a5"] * L2_["a4,a5,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a3"] * T2["c1,a3,a4,a5"] * L2_["a4,a5,a1,a2"];
    C0 += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a3"] * T2["c1,a4,a5,a6"] * L3_["a3,a5,a6,a1,a2,a4"];
    C0 += (-1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a3,a5,a6"] * L3_["a4,a5,a6,a0,a1,a2"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["c0,a2,v0,a1"] * T2["a4,a5,v1,a3"] * L1_["a0,a2"] * L2_["a1,a3,a4,a5"];
    C0 += -1.0 * H2["v0,v1,c0,a0"] * T2["c0,a2,v0,a1"] * T2["a4,a5,v1,a3"] * L1_["a1,a4"] * L2_["a0,a3,a2,a5"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["c0,a2,v0,a1"] * T2["a4,a5,v1,a3"] * L1_["a3,a2"] * L2_["a0,a1,a4,a5"];
    C0 += (1.0 / 4.0) * H2["v0,v1,c0,a0"] * T2["a1,a2,v0,v1"] * T2["c0,a3,a4,a5"] * L1_["a0,a1"] * L2_["a4,a5,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,c0,a0"] * T2["a1,a2,v0,v1"] * T2["c0,a3,a4,a5"] * L1_["a4,a1"] * L2_["a0,a5,a2,a3"];
    C0 += 1.0 * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a5,a6,v1,a3"] * L1_["a0,a5"] * L2_["a1,a2,a4,a6"];
    C0 += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a5,a6,v1,a3"] * L1_["a2,a5"] * L2_["a0,a1,a4,a6"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a0,a3"] * L3_["a1,a2,a5,a4,a6,a7"];
    C0 += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a5,a3"] * L3_["a0,a1,a2,a4,a6,a7"];
    C0 += (-1.0 / 8.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L2_["a0,a1,a3,a4"] * L2_["a2,a5,a6,a7"];
    C0 += (1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L2_["a0,a1,a3,a6"] * L2_["a2,a5,a4,a7"];
    C0 += -1.0 * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L2_["a0,a2,a3,a6"] * L2_["a1,a5,a4,a7"];
    C0 += (-1.0 / 4.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L2_["a0,a5,a3,a4"] * L2_["a1,a2,a6,a7"];
    C0 += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,a2,v0,a1"] * T2["c1,a3,a4,a5"] * L1_["a1,a0"] * L2_["a4,a5,a2,a3"];
    C0 += (1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["c0,a2,v0,a1"] * T2["c1,a3,a4,a5"] * L1_["a1,a3"] * L2_["a4,a5,a0,a2"];
    C0 += 1.0 * H2["v0,a0,c0,c1"] * T2["c0,a2,v0,a1"] * T2["c1,a3,a4,a5"] * L1_["a4,a2"] * L2_["a1,a5,a0,a3"];
    C0 += (1.0 / 4.0) * H2["v0,a0,c0,c1"] * T2["a2,a3,v0,a1"] * T2["c0,c1,a4,a5"] * L1_["a4,a0"] * L2_["a1,a5,a2,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a0,c0,c1"] * T2["a2,a3,v0,a1"] * T2["c0,c1,a4,a5"] * L1_["a4,a2"] * L2_["a1,a5,a0,a3"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["c0,a5,a1,a6"] * T2["a3,a4,v0,a2"] * L1_["a0,a5"] * L2_["a2,a6,a3,a4"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["c0,a5,a1,a6"] * T2["a3,a4,v0,a2"] * L1_["a2,a5"] * L2_["a0,a6,a3,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["c0,a5,a1,a6"] * T2["a3,a4,v0,a2"] * L1_["a6,a3"] * L2_["a0,a2,a4,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a2,a3,v0,a1"] * T2["c0,a4,a5,a6"] * L1_["a0,a2"] * L2_["a5,a6,a3,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a2,a3,v0,a1"] * T2["c0,a4,a5,a6"] * L1_["a5,a2"] * L2_["a0,a6,a3,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a6"] * L1_["a0,a5"] * L2_["a2,a6,a1,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a6"] * L1_["a2,a5"] * L2_["a0,a6,a1,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a6"] * L1_["a6,a1"] * L2_["a0,a2,a4,a5"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a3,a6"] * L1_["a6,a4"] * L2_["a0,a2,a1,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a2,a5,a6"] * L1_["a0,a3"] * L2_["a5,a6,a1,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a2,a5,a6"] * L1_["a5,a3"] * L2_["a0,a6,a1,a4"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a3"] * L3_["a2,a6,a7,a1,a4,a5"];
    C0 += (-1.0 / 4.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a5"] * L3_["a2,a6,a7,a1,a3,a4"];
    C0 += (-1.0 / 4.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a2,a1"] * L3_["a0,a6,a7,a3,a4,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a2,a5"] * L3_["a0,a6,a7,a1,a3,a4"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a6,a1"] * L3_["a0,a2,a7,a3,a4,a5"];
    C0 += -2.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a6,a3"] * L3_["a0,a2,a7,a1,a4,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a2,a1,a3"] * L2_["a6,a7,a4,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a2,a1,a5"] * L2_["a6,a7,a3,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a2,a4,a5"] * L2_["a6,a7,a1,a3"];
    C0 += -2.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a6,a1,a3"] * L2_["a2,a7,a4,a5"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a6,a1,a5"] * L2_["a2,a7,a3,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a7,a3,a4"] * L2_["a2,a6,a1,a5"];
    C0 += 2.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L2_["a0,a7,a4,a5"] * L2_["a2,a6,a1,a3"];
    C0 += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a3"] * T2["c1,a4,a5,a6"] * L1_["a3,a1"] * L2_["a5,a6,a2,a4"];
    C0 += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a3"] * T2["c1,a4,a5,a6"] * L1_["a3,a4"] * L2_["a5,a6,a1,a2"];
    C0 += 1.0 * H2["a0,a1,c0,c1"] * T2["c0,a2,a0,a3"] * T2["c1,a4,a5,a6"] * L1_["a5,a2"] * L2_["a3,a6,a1,a4"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a3,a5,a6"] * L1_["a4,a0"] * L2_["a5,a6,a1,a2"];
    C0 += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a3,a5,a6"] * L1_["a5,a2"] * L2_["a4,a6,a0,a1"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a3,a0"] * L3_["a4,a6,a7,a1,a2,a5"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a6,a2"] * L3_["a3,a4,a7,a0,a1,a5"];
    C0 += (-1.0 / 8.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L2_["a3,a4,a0,a1"] * L2_["a6,a7,a2,a5"];
    C0 += (1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L2_["a3,a4,a1,a5"] * L2_["a6,a7,a0,a2"];
    C0 += (1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L2_["a3,a6,a0,a1"] * L2_["a4,a7,a2,a5"];
    C0 += -1.0 * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L2_["a3,a6,a0,a2"] * L2_["a4,a7,a1,a5"];
    C0 += (-1.0 / 4.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a0,a3"] * L1_["a1,a4"] * L2_["a2,a5,a6,a7"];
    C0 += -1.0 * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a0,a3"] * L1_["a2,a6"] * L2_["a1,a5,a4,a7"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a0,a3"] * L1_["a5,a4"] * L2_["a1,a2,a6,a7"];
    C0 += (-1.0 / 2.0) * H2["v0,v1,a0,a1"] * T2["a3,a4,v0,a2"] * T2["a6,a7,v1,a5"] * L1_["a2,a6"] * L1_["a5,a3"] * L2_["a0,a1,a4,a7"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a3"] * L1_["a2,a1"] * L2_["a6,a7,a4,a5"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a3"] * L1_["a2,a5"] * L2_["a6,a7,a1,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a3"] * L1_["a6,a4"] * L2_["a2,a7,a1,a5"];
    C0 += (1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a5"] * L1_["a6,a1"] * L2_["a2,a7,a3,a4"];
    C0 += -1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a0,a5"] * L1_["a6,a3"] * L2_["a2,a7,a1,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a2,a1"] * L1_["a6,a3"] * L2_["a0,a7,a4,a5"];
    C0 += (-1.0 / 2.0) * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a2,a5"] * L1_["a6,a1"] * L2_["a0,a7,a3,a4"];
    C0 += 2.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a2,a5"] * L1_["a6,a3"] * L2_["a0,a7,a1,a4"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a6,a1"] * L1_["a7,a3"] * L2_["a0,a2,a4,a5"];
    C0 += 1.0 * H2["v0,a1,c0,a0"] * T2["a3,a4,v0,a2"] * T2["c0,a5,a6,a7"] * L1_["a6,a3"] * L1_["a7,a4"] * L2_["a0,a2,a1,a5"];
    C0 += (-1.0 / 4.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a3,a0"] * L1_["a4,a1"] * L2_["a6,a7,a2,a5"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a3,a0"] * L1_["a4,a5"] * L2_["a6,a7,a1,a2"];
    C0 += -1.0 * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a3,a0"] * L1_["a6,a2"] * L2_["a4,a7,a1,a5"];
    C0 += (-1.0 / 2.0) * H2["a0,a1,c0,c1"] * T2["c0,a2,a3,a4"] * T2["c1,a5,a6,a7"] * L1_["a3,a5"] * L1_["a6,a2"] * L2_["a4,a7,a0,a1"];

    comm2_O_Ta_C1(H2, T1, T2, C1);

    comm2_O_Ta_C2_ccvv(H2, T1, T2, C2);
    comm2_O_Ta_C2_cavv(H2, T1, T2, C2);
    comm2_O_Ta_C2_aavv(H2, T1, T2, C2);
    comm2_O_Ta_C2_aavc(H2, T1, T2, C2);
    comm2_O_Ta_C2_cavc(H2, T1, T2, C2);
    comm2_O_Ta_C2_ccvc(H2, T1, T2, C2);
    comm2_O_Ta_C2_ccva(H2, T1, T2, C2);
    comm2_O_Ta_C2_cava(H2, T1, T2, C2);
    comm2_O_Ta_C2_aava(H2, T1, T2, C2);
    comm2_O_Ta_C2_vcvv(H2, T1, T2, C2);
    comm2_O_Ta_C2_vavv(H2, T1, T2, C2);
    comm2_O_Ta_C2_vavc(H2, T1, T2, C2);
    comm2_O_Ta_C2_vcvc(H2, T1, T2, C2);
    comm2_O_Ta_C2_vcva(H2, T1, T2, C2);
    comm2_O_Ta_C2_vava(H2, T1, T2, C2);
    comm2_O_Ta_C2_vvvv(H2, T1, T2, C2);
    comm2_O_Ta_C2_vvvc(H2, T1, T2, C2);
    comm2_O_Ta_C2_vvva(H2, T1, T2, C2);
    comm2_O_Ta_C2_aacc(H2, T1, T2, C2);
    comm2_O_Ta_C2_vaca(H2, T1, T2, C2);
    comm2_O_Ta_C2_aaca(H2, T1, T2, C2);
    comm2_O_Ta_C2_vccc(H2, T1, T2, C2);
    comm2_O_Ta_C2_cacc(H2, T1, T2, C2);
    comm2_O_Ta_C2_vcca(H2, T1, T2, C2);
    comm2_O_Ta_C2_caca(H2, T1, T2, C2);
    comm2_O_Ta_C2_cccc(H2, T1, T2, C2);
    comm2_O_Ta_C2_ccca(H2, T1, T2, C2);
    comm2_O_Ta_C2_vvaa(H2, T1, T2, C2);
    comm2_O_Ta_C2_vcaa(H2, T1, T2, C2);
    comm2_O_Ta_C2_ccaa(H2, T1, T2, C2);
    comm2_O_Ta_C2_vaaa(H2, T1, T2, C2);
    comm2_O_Ta_C2_caaa(H2, T1, T2, C2);
    comm2_O_Ta_C2_aaaa(H2, T1, T2, C2);

    double factor = 1.0 / (k * (k + 1));
    C0 *= factor;
    C1.scale(factor);
    C2.scale(factor);
}

} // namespace forte
